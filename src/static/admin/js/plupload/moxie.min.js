(function(B,y){function N(f,e){for(var b,a=[],d=0;d<f.length;++d){if(!(b=G[f[d]]))a:{b=B;for(var h=f[d].split(/[.\/]/),c=0;c<h.length;++c){if(!b[h[c]]){b=void 0;break a}b=b[h[c]]}}if(!b)throw"module definition dependecy not found: "+f[d];a.push(b)}e.apply(null,a)}function p(f,e,b){if("string"!==typeof f)throw"invalid module definition, module id must be defined and be a string";if(e===y)throw"invalid module definition, dependencies must be specified";if(b===y)throw"invalid module definition, definition function must be specified";
N(e,function(){G[f]=b.apply(null,arguments)})}var G={};p("moxie/core/utils/Basic",[],function(){var f=function(a){return void 0===a?"undefined":null===a?"null":a.nodeType?"node":{}.toString.call(a).match(/\s([a-z|A-Z]+)/)[1].toLowerCase()},e=function(d){b(arguments,function(h,c){0<c&&b(h,function(c,k){void 0!==c&&(f(d[k])===f(c)&&~a(f(c),["array","object"])?e(d[k],c):d[k]=c)})});return d},b=function(a,h){var c,b;if(a){try{c=a.length}catch(k){c=void 0}if(void 0===c)for(b in a){if(a.hasOwnProperty(b)&&
!1===h(a[b],b))break}else for(b=0;b<c&&!1!==h(a[b],b);b++);}},a=function(a,b){if(b){if(Array.prototype.indexOf)return Array.prototype.indexOf.call(b,a);for(var c=0,g=b.length;c<g;c++)if(b[c]===a)return c}return-1};return{guid:function(){var a=0;return function(b){var c=(new Date).getTime().toString(32),g;for(g=0;5>g;g++)c+=Math.floor(65535*Math.random()).toString(32);return(b||"o_")+c+(a++).toString(32)}}(),typeOf:f,extend:e,each:b,isEmptyObj:function(a){var b;if(!a||"object"!==f(a))return!0;for(b in a)return!1;
return!0},inSeries:function(a,b){function c(k){if("function"===f(a[k]))a[k](function(a){++k<g&&!a?c(k):b(a)})}var g=a.length;"function"!==f(b)&&(b=function(){});a&&a.length||b();c(0)},inParallel:function(a,h){var c=0,g=a.length,k=Array(g);b(a,function(a,d){a(function(a){if(a)return h(a);var b=[].slice.call(arguments);b.shift();k[d]=b;c++;c===g&&(k.unshift(null),h.apply(this,k))})})},inArray:a,arrayDiff:function(d,b){var c=[];"array"!==f(d)&&(d=[d]);"array"!==f(b)&&(b=[b]);for(var g in d)-1===a(d[g],
b)&&c.push(d[g]);return c.length?c:!1},arrayIntersect:function(d,h){var c=[];b(d,function(d){-1!==a(d,h)&&c.push(d)});return c.length?c:null},toArray:function(a){var b,c=[];for(b=0;b<a.length;b++)c[b]=a[b];return c},trim:function(a){return a?String.prototype.trim?String.prototype.trim.call(a):a.toString().replace(/^\s*/,"").replace(/\s*$/,""):a},parseSizeStr:function(a){if("string"!==typeof a)return a;var b={t:1099511627776,g:1073741824,m:1048576,k:1024},c;a=/^([0-9]+)([mgk]?)$/.exec(a.toLowerCase().replace(/[^0-9mkg]/g,
""));c=a[2];a=+a[1];b.hasOwnProperty(c)&&(a*=b[c]);return a}}});p("moxie/core/I18n",["moxie/core/utils/Basic"],function(f){var e={};return{addI18n:function(b){return f.extend(e,b)},translate:function(b){return e[b]||b},_:function(b){return this.translate(b)},sprintf:function(b){var a=[].slice.call(arguments,1);return b.replace(/%[a-z]/g,function(){var d=a.shift();return"undefined"!==f.typeOf(d)?d:""})}}});p("moxie/core/utils/Mime",["moxie/core/utils/Basic","moxie/core/I18n"],function(f,e){var b={mimes:{},
extensions:{},addMimeType:function(a){a=a.split(/,/);var d,b,c;for(d=0;d<a.length;d+=2){c=a[d+1].split(/ /);for(b=0;b<c.length;b++)this.mimes[c[b]]=a[d];this.extensions[a[d]]=c}},extList2mimes:function(a,d){var b,c,g,k,r=[];for(c=0;c<a.length;c++)for(b=a[c].extensions.split(/\s*,\s*/),g=0;g<b.length;g++){if("*"===b[g])return[];if(k=this.mimes[b[g]])-1===f.inArray(k,r)&&r.push(k);else if(d&&/^\w+$/.test(b[g]))r.push("."+b[g]);else return[]}return r},mimes2exts:function(a){var d=this,b=[];f.each(a,
function(a){if("*"===a)return b=[],!1;var g=a.match(/^(\w+)\/(\*|\w+)$/);g&&("*"===g[2]?f.each(d.extensions,function(a,c){(new RegExp("^"+g[1]+"/")).test(c)&&[].push.apply(b,d.extensions[c])}):d.extensions[a]&&[].push.apply(b,d.extensions[a]))});return b},mimes2extList:function(a){var d=[],b=[];"string"===f.typeOf(a)&&(a=f.trim(a).split(/\s*,\s*/));b=this.mimes2exts(a);d.push({title:e.translate("Files"),extensions:b.length?b.join(","):"*"});d.mimes=a;return d},getFileExtension:function(a){return(a=
a&&a.match(/\.([^.]+)$/))?a[1].toLowerCase():""},getFileMime:function(a){return this.mimes[this.getFileExtension(a)]||""}};b.addMimeType("application/msword,doc dot,application/pdf,pdf,application/pgp-signature,pgp,application/postscript,ps ai eps,application/rtf,rtf,application/vnd.ms-excel,xls xlb,application/vnd.ms-powerpoint,ppt pps pot,application/zip,zip,application/x-shockwave-flash,swf swfl,application/vnd.openxmlformats-officedocument.wordprocessingml.document,docx,application/vnd.openxmlformats-officedocument.wordprocessingml.template,dotx,application/vnd.openxmlformats-officedocument.spreadsheetml.sheet,xlsx,application/vnd.openxmlformats-officedocument.presentationml.presentation,pptx,application/vnd.openxmlformats-officedocument.presentationml.template,potx,application/vnd.openxmlformats-officedocument.presentationml.slideshow,ppsx,application/x-javascript,js,application/json,json,audio/mpeg,mp3 mpga mpega mp2,audio/x-wav,wav,audio/x-m4a,m4a,audio/ogg,oga ogg,audio/aiff,aiff aif,audio/flac,flac,audio/aac,aac,audio/ac3,ac3,audio/x-ms-wma,wma,image/bmp,bmp,image/gif,gif,image/jpeg,jpg jpeg jpe,image/photoshop,psd,image/png,png,image/svg+xml,svg svgz,image/tiff,tiff tif,text/plain,asc txt text diff log,text/html,htm html xhtml,text/css,css,text/csv,csv,text/rtf,rtf,video/mpeg,mpeg mpg mpe m2v,video/quicktime,qt mov,video/mp4,mp4,video/x-m4v,m4v,video/x-flv,flv,video/x-ms-wmv,wmv,video/avi,avi,video/webm,webm,video/3gpp,3gpp 3gp,video/3gpp2,3g2,video/vnd.rn-realvideo,rv,video/ogg,ogv,video/x-matroska,mkv,application/vnd.oasis.opendocument.formula-template,otf,application/octet-stream,exe");
return b});p("moxie/core/utils/Env",["moxie/core/utils/Basic"],function(f){var e=function(a){var d={has:function(a,c){return-1!==c.toLowerCase().indexOf(a.toLowerCase())},lowerize:function(a){return a.toLowerCase()}},b=function(){for(var c,b=0,d,k,g,l,h,f=arguments;b<f.length;b+=2){h=f[b];var e=f[b+1];if("undefined"===typeof c)for(g in c={},e)d=e[g],"object"===typeof d?c[d[0]]=a:c[d]=a;for(d=k=0;d<h.length;d++)if(l=h[d].exec(this.getUA())){for(g=0;g<e.length;g++)h=l[++k],d=e[g],"object"===typeof d&&
0<d.length?2==d.length?c[d[0]]="function"==typeof d[1]?d[1].call(this,h):d[1]:3==d.length?c[d[0]]="function"!==typeof d[1]||d[1].exec&&d[1].test?h?h.replace(d[1],d[2]):a:h?d[1].call(this,h,d[2]):a:4==d.length&&(c[d[0]]=h?d[3].call(this,h.replace(d[1],d[2])):a):c[d]=h?h:a;break}if(l)break}return c},c=function(c,b){for(var k in b)if("object"===typeof b[k]&&0<b[k].length)for(var g=0;g<b[k].length;g++){if(d.has(b[k][g],c))return"?"===k?a:k}else if(d.has(b[k],c))return"?"===k?a:k;return c},g={ME:"4.90",
"NT 3.11":"NT3.51","NT 4.0":"NT4.0",2E3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2","8.1":"NT 6.3",RT:"ARM"},k=[[/(opera\smini)\/((\d+)?[\w\.-]+)/i,/(opera\s[mobiletab]+).+version\/((\d+)?[\w\.-]+)/i,/(opera).+version\/((\d+)?[\w\.]+)/i,/(opera)[\/\s]+((\d+)?[\w\.]+)/i],["name","version","major"],[/\s(opr)\/((\d+)?[\w\.]+)/i],[["name","Opera"],"version","major"],[/(kindle)\/((\d+)?[\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/\s]?((\d+)?[\w\.]+)*/i,/(avant\s|iemobile|slim|baidu)(?:browser)?[\/\s]?((\d+)?[\w\.]*)/i,
/(?:ms|\()(ie)\s((\d+)?[\w\.]+)/i,/(rekonq)((?:\/)[\w\.]+)*/i,/(chromium|flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron)\/((\d+)?[\w\.-]+)/i],["name","version","major"],[/(trident).+rv[:\s]((\d+)?[\w\.]+).+like\sgecko/i],[["name","IE"],"version","major"],[/(yabrowser)\/((\d+)?[\w\.]+)/i],[["name","Yandex"],"version","major"],[/(comodo_dragon)\/((\d+)?[\w\.]+)/i],[["name",/_/g," "],"version","major"],[/(chrome|omniweb|arora|[tizenoka]{5}\s?browser)\/v?((\d+)?[\w\.]+)/i],["name","version",
"major"],[/(dolfin)\/((\d+)?[\w\.]+)/i],[["name","Dolphin"],"version","major"],[/((?:android.+)crmo|crios)\/((\d+)?[\w\.]+)/i],[["name","Chrome"],"version","major"],[/((?:android.+))version\/((\d+)?[\w\.]+)\smobile\ssafari/i],[["name","Android Browser"],"version","major"],[/version\/((\d+)?[\w\.]+).+?mobile\/\w+\s(safari)/i],["version","major",["name","Mobile Safari"]],[/version\/((\d+)?[\w\.]+).+?(mobile\s?safari|safari)/i],["version","major","name"],[/webkit.+?(mobile\s?safari|safari)((\/[\w\.]+))/i],
["name",["major",c,{1:["/8","/1","/3"],2:"/4","?":"/"}],["version",c,{"1.0":"/8","1.2":"/1","1.3":"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}]],[/(konqueror)\/((\d+)?[\w\.]+)/i,/(webkit|khtml)\/((\d+)?[\w\.]+)/i],["name","version","major"],[/(navigator|netscape)\/((\d+)?[\w\.-]+)/i],[["name","Netscape"],"version","major"],[/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo\sbrowser|minimo|conkeror)[\/\s]?((\d+)?[\w\.\+]+)/i,/(firefox|seamonkey|k-meleon|icecat|iceape|firebird|phoenix)\/((\d+)?[\w\.-]+)/i,
/(mozilla)\/((\d+)?[\w\.]+).+rv\:.+gecko\/\d+/i,/(uc\s?browser|polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|qqbrowser)[\/\s]?((\d+)?[\w\.]+)/i,/(links)\s\(((\d+)?[\w\.]+)/i,/(gobrowser)\/?((\d+)?[\w\.]+)*/i,/(ice\s?browser)\/v?((\d+)?[\w\._]+)/i,/(mosaic)[\/\s]((\d+)?[\w\.]+)/i],["name","version","major"]],f=[[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m)\/([\w\.]+)/i,/(khtml|tasman|links)[\/\s]\(?([\w\.]+)/i,/(icab)[\/\s]([23]\.[\d\.]+)/i],["name","version"],[/rv\:([\w\.]+).*(gecko)/i],
["version","name"]],l=[[/(windows)\snt\s6\.2;\s(arm)/i,/(windows\sphone(?:\sos)*|windows\smobile|windows)[\s\/]?([ntce\d\.\s]+\w)/i],["name",["version",c,g]],[/(win(?=3|9|n)|win\s9x\s)([nt\d\.]+)/i],[["name","Windows"],["version",c,g]],[/\((bb)(10);/i],[["name","BlackBerry"],"version"],[/(blackberry)\w*\/?([\w\.]+)*/i,/(tizen)\/([\w\.]+)/i,/(android|webos|palm\os|qnx|bada|rim\stablet\sos|meego)[\/\s-]?([\w\.]+)*/i],["name","version"],[/(symbian\s?os|symbos|s60(?=;))[\/\s-]?([\w\.]+)*/i],[["name",
"Symbian"],"version"],[/mozilla.+\(mobile;.+gecko.+firefox/i],[["name","Firefox OS"],"version"],[/(nintendo|playstation)\s([wids3portablevu]+)/i,/(mint)[\/\s\(]?(\w+)*/i,/(joli|[kxln]?ubuntu|debian|[open]*suse|gentoo|arch|slackware|fedora|mandriva|centos|pclinuxos|redhat|zenwalk)[\/\s-]?([\w\.-]+)*/i,/(hurd|linux)\s?([\w\.]+)*/i,/(gnu)\s?([\w\.]+)*/i],["name","version"],[/(cros)\s[\w]+\s([\w\.]+\w)/i],[["name","Chromium OS"],"version"],[/(sunos)\s?([\w\.]+\d)*/i],[["name","Solaris"],"version"],[/\s([frentopc-]{0,4}bsd|dragonfly)\s?([\w\.]+)*/i],
["name","version"],[/(ip[honead]+)(?:.*os\s*([\w]+)*\slike\smac|;\sopera)/i],[["name","iOS"],["version",/_/g,"."]],[/(mac\sos\sx)\s?([\w\s\.]+\w)*/i],["name",["version",/_/g,"."]],[/(haiku)\s(\w+)/i,/(aix)\s((\d)(?=\.|\)|\s)[\w\.]*)*/i,/(macintosh|mac(?=_powerpc)|plan\s9|minix|beos|os\/2|amigaos|morphos|risc\sos)/i,/(unix)\s?([\w\.]+)*/i],["name","version"]];return(new function(a){var d=a||(window&&window.navigator&&window.navigator.userAgent?window.navigator.userAgent:"");this.getBrowser=function(){return b.apply(this,
k)};this.getEngine=function(){return b.apply(this,f)};this.getOS=function(){return b.apply(this,l)};this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS()}};this.getUA=function(){return d};this.setUA=function(a){d=a;return this};this.setUA(d)}).getResult()}(),b={can:function(){var a={define_property:!1,create_canvas:function(){var a=document.createElement("canvas");return!(!a.getContext||!a.getContext("2d"))}(),return_response_type:function(a){try{if(-1!==
f.inArray(a,["","text","document"]))return!0;if(window.XMLHttpRequest){var b=new XMLHttpRequest;b.open("get","/");if("responseType"in b)return b.responseType=a,b.responseType!==a?!1:!0}}catch(c){}return!1},use_data_uri:function(){var d=new Image;d.onload=function(){a.use_data_uri=1===d.width&&1===d.height};setTimeout(function(){d.src="data:image/gif;base64,R0lGODlhAQABAIAAAP8AAAAAACH5BAAAAAAALAAAAAABAAEAAAICRAEAOw=="},1);return!1}(),use_data_uri_over32kb:function(){return a.use_data_uri&&("IE"!==
b.browser||9<=b.version)},use_data_uri_of:function(d){return a.use_data_uri&&33E3>d||a.use_data_uri_over32kb()},use_fileinput:function(){var a=document.createElement("input");a.setAttribute("type","file");return!a.disabled}};return function(d){var b=[].slice.call(arguments);b.shift();return"function"===f.typeOf(a[d])?a[d].apply(this,b):!!a[d]}}(),browser:e.browser.name,version:parseFloat(e.browser.major),os:e.os.name,osVersion:e.os.version,verComp:function(a,d,b){var c=0,g=0,k=0,f={dev:-6,alpha:-5,
a:-5,beta:-4,b:-4,RC:-3,rc:-3,"#":-2,p:1,pl:1},c=function(a){a=(""+a).replace(/[_\-+]/g,".");a=a.replace(/([^.\d]+)/g,".$1.").replace(/\.{2,}/g,".");return a.length?a.split("."):[-8]},l=function(a){return a?isNaN(a)?f[a]||-7:parseInt(a,10):0};a=c(a);d=c(d);g=Math.max(a.length,d.length);for(c=0;c<g;c++)if(a[c]!=d[c])if(a[c]=l(a[c]),d[c]=l(d[c]),a[c]<d[c]){k=-1;break}else if(a[c]>d[c]){k=1;break}if(!b)return k;switch(b){case ">":case "gt":return 0<k;case ">=":case "ge":return 0<=k;case "<=":case "le":return 0>=
k;case "==":case "=":case "eq":return 0===k;case "<>":case "!=":case "ne":return 0!==k;case "":case "<":case "lt":return 0>k;default:return null}},swf_url:"../flash/Moxie.swf",xap_url:"../silverlight/Moxie.xap",global_event_dispatcher:"moxie.core.EventTarget.instance.dispatchEvent"};b.OS=b.os;return b});p("moxie/core/utils/Dom",["moxie/core/utils/Env"],function(f){var e=function(b,a){return b.className?(new RegExp("(^|\\s+)"+a+"(\\s+|$)")).test(b.className):!1};return{get:function(b){return"string"!==
typeof b?b:document.getElementById(b)},hasClass:e,addClass:function(b,a){e(b,a)||(b.className=b.className?b.className.replace(/\s+$/,"")+" "+a:a)},removeClass:function(b,a){b.className&&(b.className=b.className.replace(new RegExp("(^|\\s+)"+a+"(\\s+|$)"),function(a,b,c){return" "===b&&" "===c?" ":""}))},getStyle:function(b,a){if(b.currentStyle)return b.currentStyle[a];if(window.getComputedStyle)return window.getComputedStyle(b,null)[a]},getPos:function(b,a){function d(a){var c,b=0;c=0;a&&(c=a.getBoundingClientRect(),
a="CSS1Compat"===k.compatMode?k.documentElement:k.body,b=c.left+a.scrollLeft,c=c.top+a.scrollTop);return{x:b,y:c}}var h=0,c=0,g,k=document;a=a||k.body;if(b&&b.getBoundingClientRect&&"IE"===f.browser&&(!k.documentMode||8>k.documentMode))return h=d(b),c=d(a),{x:h.x-c.x,y:h.y-c.y};for(g=b;g&&g!=a&&g.nodeType;)h+=g.offsetLeft||0,c+=g.offsetTop||0,g=g.offsetParent;for(g=b.parentNode;g&&g!=a&&g.nodeType;)h-=g.scrollLeft||0,c-=g.scrollTop||0,g=g.parentNode;return{x:h,y:c}},getSize:function(b){return{w:b.offsetWidth||
b.clientWidth,h:b.offsetHeight||b.clientHeight}}}});p("moxie/core/Exceptions",["moxie/core/utils/Basic"],function(f){function e(b,a){for(var d in b)if(b[d]===a)return d;return null}return{RuntimeError:function(){function b(b){this.code=b;this.name=e(a,b);this.message=this.name+": RuntimeError "+this.code}var a={NOT_INIT_ERR:1,NOT_SUPPORTED_ERR:9,JS_ERR:4};f.extend(b,a);b.prototype=Error.prototype;return b}(),OperationNotAllowedException:function(){function b(a){this.code=a;this.name="OperationNotAllowedException"}
f.extend(b,{NOT_ALLOWED_ERR:1});b.prototype=Error.prototype;return b}(),ImageError:function(){function b(b){this.code=b;this.name=e(a,b);this.message=this.name+": ImageError "+this.code}var a={WRONG_FORMAT:1,MAX_RESOLUTION_ERR:2};f.extend(b,a);b.prototype=Error.prototype;return b}(),FileException:function(){function b(b){this.code=b;this.name=e(a,b);this.message=this.name+": FileException "+this.code}var a={NOT_FOUND_ERR:1,SECURITY_ERR:2,ABORT_ERR:3,NOT_READABLE_ERR:4,ENCODING_ERR:5,NO_MODIFICATION_ALLOWED_ERR:6,
INVALID_STATE_ERR:7,SYNTAX_ERR:8};f.extend(b,a);b.prototype=Error.prototype;return b}(),DOMException:function(){function b(b){this.code=b;this.name=e(a,b);this.message=this.name+": DOMException "+this.code}var a={INDEX_SIZE_ERR:1,DOMSTRING_SIZE_ERR:2,HIERARCHY_REQUEST_ERR:3,WRONG_DOCUMENT_ERR:4,INVALID_CHARACTER_ERR:5,NO_DATA_ALLOWED_ERR:6,NO_MODIFICATION_ALLOWED_ERR:7,NOT_FOUND_ERR:8,NOT_SUPPORTED_ERR:9,INUSE_ATTRIBUTE_ERR:10,INVALID_STATE_ERR:11,SYNTAX_ERR:12,INVALID_MODIFICATION_ERR:13,NAMESPACE_ERR:14,
INVALID_ACCESS_ERR:15,VALIDATION_ERR:16,TYPE_MISMATCH_ERR:17,SECURITY_ERR:18,NETWORK_ERR:19,ABORT_ERR:20,URL_MISMATCH_ERR:21,QUOTA_EXCEEDED_ERR:22,TIMEOUT_ERR:23,INVALID_NODE_TYPE_ERR:24,DATA_CLONE_ERR:25};f.extend(b,a);b.prototype=Error.prototype;return b}(),EventException:function(){function b(a){this.code=a;this.name="EventException"}f.extend(b,{UNSPECIFIED_EVENT_TYPE_ERR:0});b.prototype=Error.prototype;return b}()}});p("moxie/core/EventTarget",["moxie/core/Exceptions","moxie/core/utils/Basic"],
function(f,e){function b(){var a={};e.extend(this,{uid:null,init:function(){this.uid||(this.uid=e.guid("uid_"))},addEventListener:function(b,h,c,g){var k=this,f;b=e.trim(b);/\s/.test(b)?e.each(b.split(/\s+/),function(a){k.addEventListener(a,h,c,g)}):(b=b.toLowerCase(),c=parseInt(c,10)||0,f=a[this.uid]&&a[this.uid][b]||[],f.push({fn:h,priority:c,scope:g||this}),a[this.uid]||(a[this.uid]={}),a[this.uid][b]=f)},hasEventListener:function(b){return b?!(!a[this.uid]||!a[this.uid][b]):!!a[this.uid]},removeEventListener:function(b,
h){b=b.toLowerCase();var c=a[this.uid]&&a[this.uid][b],g;if(c){if(h)for(g=c.length-1;0<=g;g--){if(c[g].fn===h){c.splice(g,1);break}}else c=[];c.length||(delete a[this.uid][b],e.isEmptyObj(a[this.uid])&&delete a[this.uid])}},removeAllEventListeners:function(){a[this.uid]&&delete a[this.uid]},dispatchEvent:function(b){var h,c,g,k={},r=!0;if("string"!==e.typeOf(b))if(c=b,"string"===e.typeOf(c.type))b=c.type,void 0!==c.total&&void 0!==c.loaded&&(k.total=c.total,k.loaded=c.loaded),k.async=c.async||!1;
else throw new f.EventException(f.EventException.UNSPECIFIED_EVENT_TYPE_ERR);-1!==b.indexOf("::")?function(a){h=a[0];b=a[1]}(b.split("::")):h=this.uid;b=b.toLowerCase();if(c=a[h]&&a[h][b]){c.sort(function(a,b){return b.priority-a.priority});g=[].slice.call(arguments);g.shift();k.type=b;g.unshift(k);var l=[];e.each(c,function(a){g[0].target=a.scope;k.async?l.push(function(b){setTimeout(function(){b(!1===a.fn.apply(a.scope,g))},1)}):l.push(function(b){b(!1===a.fn.apply(a.scope,g))})});l.length&&e.inSeries(l,
function(a){r=!a})}return r},bind:function(){this.addEventListener.apply(this,arguments)},unbind:function(){this.removeEventListener.apply(this,arguments)},unbindAll:function(){this.removeAllEventListeners.apply(this,arguments)},trigger:function(){return this.dispatchEvent.apply(this,arguments)},convertEventPropsToHandlers:function(a){var b;"array"!==e.typeOf(a)&&(a=[a]);for(var c=0;c<a.length;c++)b="on"+a[c],"function"===e.typeOf(this[b])?this.addEventListener(a[c],this[b]):"undefined"===e.typeOf(this[b])&&
(this[b]=null)}})}b.instance=new b;return b});p("moxie/core/utils/Encode",[],function(){var f=function(b){return unescape(encodeURIComponent(b))},e=function(b){return decodeURIComponent(escape(b))};return{utf8_encode:f,utf8_decode:e,atob:function(b,a){if("function"===typeof window.atob)return a?e(window.atob(b)):window.atob(b);var d,h,c,g,k,f=0,l=0;g="";var n=[];if(!b)return b;b+="";do d="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(b.charAt(f++)),h="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(b.charAt(f++)),
g="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(b.charAt(f++)),k="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(b.charAt(f++)),c=d<<18|h<<12|g<<6|k,d=c>>16&255,h=c>>8&255,c&=255,64==g?n[l++]=String.fromCharCode(d):64==k?n[l++]=String.fromCharCode(d,h):n[l++]=String.fromCharCode(d,h,c);while(f<b.length);g=n.join("");return a?e(g):g},btoa:function(b,a){a&&f(b);if("function"===typeof window.btoa)return window.btoa(b);var d,h,c,g,k=0,e=0,l="",
l=[];if(!b)return b;do d=b.charCodeAt(k++),h=b.charCodeAt(k++),c=b.charCodeAt(k++),g=d<<16|h<<8|c,d=g>>18&63,h=g>>12&63,c=g>>6&63,g&=63,l[e++]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(d)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(h)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(c)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(g);while(k<b.length);l=l.join("");k=b.length%3;return(k?
l.slice(0,k-3):l)+"===".slice(k||3)}}});p("moxie/runtime/Runtime",["moxie/core/utils/Basic","moxie/core/utils/Dom","moxie/core/EventTarget"],function(f,e,b){function a(b,d,k,r,l){var n=this,q,m=f.guid(d+"_");l=l||"browser";b=b||{};h[m]=this;k=f.extend({access_binary:!1,access_image_binary:!1,display_media:!1,do_cors:!1,drag_and_drop:!1,filter_by_extension:!0,resize_image:!1,report_upload_progress:!1,return_response_headers:!1,return_response_type:!1,return_status_code:!0,send_custom_headers:!1,select_file:!1,
select_folder:!1,select_multiple:!0,send_binary_string:!1,send_browser_cookies:!0,send_multipart:!0,slice_blob:!1,stream_upload:!1,summon_file_dialog:!1,upload_filesize:!0,use_http_method:!0},k);b.preferred_caps&&(l=a.getMode(r,b.preferred_caps,l));q=function(){var a={};return{exec:function(b,c,d,k){if(q[c]&&(a[b]||(a[b]={context:this,instance:new q[c]}),a[b].instance[d]))return a[b].instance[d].apply(this,k)},removeInstance:function(b){delete a[b]},removeAllInstances:function(){var b=this;f.each(a,
function(a,c){"function"===f.typeOf(a.instance.destroy)&&a.instance.destroy.call(a.context);b.removeInstance(c)})}}}();f.extend(this,{initialized:!1,uid:m,type:d,mode:a.getMode(r,b.required_caps,l),shimid:m+"_container",clients:0,options:b,can:function(b,c,d){d=d||k;"string"===f.typeOf(b)&&"undefined"===f.typeOf(c)&&(b=a.parseCaps(b));if("object"===f.typeOf(b)){for(var g in b)if(!this.can(g,b[g],d))return!1;return!0}return"function"===f.typeOf(d[b])?d[b].call(this,c):c===d[b]},getShimContainer:function(){var a,
b=e.get(this.shimid);b||(a=this.options.container?e.get(this.options.container):document.body,b=document.createElement("div"),b.id=this.shimid,b.className="moxie-shim moxie-shim-"+this.type,f.extend(b.style,{position:"absolute",top:"0px",left:"0px",width:"1px",height:"1px",overflow:"hidden"}),a.appendChild(b));return b},getShim:function(){return q},shimExec:function(a,b){var c=[].slice.call(arguments,2);return n.getShim().exec.call(this,this.uid,a,b,c)},exec:function(a,b){var c=[].slice.call(arguments,
2);return n[a]&&n[a][b]?n[a][b].apply(this,c):n.shimExec.apply(this,arguments)},destroy:function(){if(n){var a=e.get(this.shimid);a&&a.parentNode.removeChild(a);q&&q.removeAllInstances();this.unbindAll();delete h[this.uid];m=n=q=this.uid=null}}});this.mode&&b.required_caps&&!this.can(b.required_caps)&&(this.mode=!1)}var d={},h={};a.order="html5,flash,silverlight,html4";a.getRuntime=function(a){return h[a]?h[a]:!1};a.addConstructor=function(a,g){g.prototype=b.instance;d[a]=g};a.getConstructor=function(a){return d[a]||
null};a.getInfo=function(b){var d=a.getRuntime(b);return d?{uid:d.uid,type:d.type,mode:d.mode,can:function(){return d.can.apply(d,arguments)}}:null};a.parseCaps=function(a){var b={};if("string"!==f.typeOf(a))return a||{};f.each(a.split(","),function(a){b[a]=!0});return b};a.can=function(b,d){var k;k=a.getConstructor(b);var f;return k?(k=new k({required_caps:d}),f=k.mode,k.destroy(),!!f):!1};a.thatCan=function(b,d){var k=(d||a.order).split(/\s*,\s*/),f;for(f in k)if(a.can(k[f],b))return k[f];return null};
a.getMode=function(a,b,d){var h=null;"undefined"===f.typeOf(d)&&(d="browser");if(b&&!f.isEmptyObj(a)){f.each(b,function(b,d){if(a.hasOwnProperty(d)){var k=a[d](b);"string"===typeof k&&(k=[k]);if(!h)h=k;else if(!(h=f.arrayIntersect(h,k)))return h=!1}});if(h)return-1!==f.inArray(d,h)?d:h[0];if(!1===h)return!1}return d};a.capTrue=function(){return!0};a.capFalse=function(){return!1};a.capTest=function(a){return function(){return!!a}};return a});p("moxie/runtime/RuntimeClient",["moxie/core/Exceptions",
"moxie/core/utils/Basic","moxie/runtime/Runtime"],function(f,e,b){return function(){var a;e.extend(this,{connectRuntime:function(d){function h(k){var g;k.length?(g=k.shift(),(g=b.getConstructor(g))?(a=new g(d),a.bind("Init",function(){a.initialized=!0;setTimeout(function(){a.clients++;c.trigger("RuntimeInit",a)},1)}),a.bind("Error",function(){a.destroy();h(k)}),a.mode?a.init():a.trigger("Error")):h(k)):(c.trigger("RuntimeError",new f.RuntimeError(f.RuntimeError.NOT_INIT_ERR)),a=null)}var c=this,g;
"string"===e.typeOf(d)?g=d:"string"===e.typeOf(d.ruid)&&(g=d.ruid);if(g){if(a=b.getRuntime(g))return a.clients++,a;throw new f.RuntimeError(f.RuntimeError.NOT_INIT_ERR);}h((d.runtime_order||b.order).split(/\s*,\s*/))},getRuntime:function(){return a&&a.uid?a:a=null},disconnectRuntime:function(){a&&0>=--a.clients&&(a.destroy(),a=null)}})}});p("moxie/file/Blob",["moxie/core/utils/Basic","moxie/core/utils/Encode","moxie/runtime/RuntimeClient"],function(f,e,b){function a(h,c){function g(b,c,g){var h=d[this.uid];
if("string"!==f.typeOf(h)||!h.length)return null;c=new a(null,{type:g,size:c-b});c.detach(h.substr(b,c.size));return c}b.call(this);h&&this.connectRuntime(h);c?"string"===f.typeOf(c)&&(c={data:c}):c={};f.extend(this,{uid:c.uid||f.guid("uid_"),ruid:h,size:c.size||0,type:c.type||"",slice:function(a,b,c){return this.isDetached()?g.apply(this,arguments):this.getRuntime().exec.call(this,"Blob","slice",this.getSource(),a,b,c)},getSource:function(){return d[this.uid]?d[this.uid]:null},detach:function(a){this.ruid&&
(this.getRuntime().exec.call(this,"Blob","destroy"),this.disconnectRuntime(),this.ruid=null);a=a||"";var b=a.match(/^data:([^;]*);base64,/);b&&(this.type=b[1],a=e.atob(a.substring(a.indexOf("base64,")+7)));this.size=a.length;d[this.uid]=a},isDetached:function(){return!this.ruid&&"string"===f.typeOf(d[this.uid])},destroy:function(){this.detach();delete d[this.uid]}});c.data?this.detach(c.data):d[this.uid]=c}var d={};return a});p("moxie/file/File",["moxie/core/utils/Basic","moxie/core/utils/Mime","moxie/file/Blob"],
function(f,e,b){function a(a,h){var c,g;h||(h={});g=h.type&&""!==h.type?h.type:e.getFileMime(h.name);h.name?(c=h.name.replace(/\\/g,"/"),c=c.substr(c.lastIndexOf("/")+1)):(c=g.split("/")[0],c=f.guid((""!==c?c:"file")+"_"),e.extensions[g]&&(c+="."+e.extensions[g][0]));b.apply(this,arguments);f.extend(this,{type:g||"",name:c||f.guid("file_"),lastModifiedDate:h.lastModifiedDate||(new Date).toLocaleString()})}a.prototype=b.prototype;return a});p("moxie/file/FileInput","moxie/core/utils/Basic moxie/core/utils/Mime moxie/core/utils/Dom moxie/core/Exceptions moxie/core/EventTarget moxie/core/I18n moxie/file/File moxie/runtime/Runtime moxie/runtime/RuntimeClient".split(" "),
function(f,e,b,a,d,h,c,g,k){function r(d){var q=this,r;-1!==f.inArray(f.typeOf(d),["string","node"])&&(d={browse_button:d});r=b.get(d.browse_button);if(!r)throw new a.DOMException(a.DOMException.NOT_FOUND_ERR);r={accept:[{title:h.translate("All Files"),extensions:"*"}],name:"file",multiple:!1,required_caps:!1,container:r.parentNode||document.body};d=f.extend({},r,d);"string"===typeof d.required_caps&&(d.required_caps=g.parseCaps(d.required_caps));"string"===typeof d.accept&&(d.accept=e.mimes2extList(d.accept));
r=b.get(d.container);r||(r=document.body);"static"===b.getStyle(r,"position")&&(r.style.position="relative");r=r=null;k.call(q);f.extend(q,{uid:f.guid("uid_"),ruid:null,shimid:null,files:null,init:function(){q.convertEventPropsToHandlers(l);q.bind("RuntimeInit",function(a,k){q.ruid=k.uid;q.shimid=k.shimid;q.bind("Ready",function(){q.trigger("Refresh")},999);q.bind("Change",function(){var a=k.exec.call(q,"FileInput","getFiles");q.files=[];f.each(a,function(a){if(0===a.size)return!0;q.files.push(new c(q.ruid,
a))})},999);q.bind("Refresh",function(){var a,c,g;c=b.get(d.browse_button);g=b.get(k.shimid);c&&(a=b.getPos(c,b.get(d.container)),c=b.getSize(c),g&&f.extend(g.style,{top:a.y+"px",left:a.x+"px",width:c.w+"px",height:c.h+"px"}))});k.exec.call(q,"FileInput","init",d)});q.connectRuntime(f.extend({},d,{required_caps:{select_file:!0}}))},disable:function(a){var b=this.getRuntime();b&&b.exec.call(this,"FileInput","disable","undefined"===f.typeOf(a)?!0:a)},refresh:function(){q.trigger("Refresh")},destroy:function(){var a=
this.getRuntime();a&&(a.exec.call(this,"FileInput","destroy"),this.disconnectRuntime());"array"===f.typeOf(this.files)&&f.each(this.files,function(a){a.destroy()});this.files=null}})}var l="ready change cancel mouseenter mouseleave mousedown mouseup".split(" ");r.prototype=d.instance;return r});p("moxie/file/FileDrop","moxie/core/I18n moxie/core/utils/Dom moxie/core/Exceptions moxie/core/utils/Basic moxie/file/File moxie/runtime/RuntimeClient moxie/core/EventTarget moxie/core/utils/Mime".split(" "),
function(f,e,b,a,d,h,c,g){function k(b){var c=this,k;"string"===typeof b&&(b={drop_zone:b});k={accept:[{title:f.translate("All Files"),extensions:"*"}],required_caps:{drag_and_drop:!0}};b="object"===typeof b?a.extend({},k,b):k;b.container=e.get(b.drop_zone)||document.body;"static"===e.getStyle(b.container,"position")&&(b.container.style.position="relative");"string"===typeof b.accept&&(b.accept=g.mimes2extList(b.accept));h.call(c);a.extend(c,{uid:a.guid("uid_"),ruid:null,files:null,init:function(){c.convertEventPropsToHandlers(r);
c.bind("RuntimeInit",function(k,g){c.ruid=g.uid;c.bind("Drop",function(){var b=g.exec.call(c,"FileDrop","getFiles");c.files=[];a.each(b,function(a){c.files.push(new d(c.ruid,a))})},999);g.exec.call(c,"FileDrop","init",b);c.dispatchEvent("ready")});c.connectRuntime(b)},destroy:function(){var a=this.getRuntime();a&&(a.exec.call(this,"FileDrop","destroy"),this.disconnectRuntime());this.files=null}})}var r=["ready","dragenter","dragleave","drop","error"];k.prototype=c.instance;return k});p("moxie/runtime/RuntimeTarget",
["moxie/core/utils/Basic","moxie/runtime/RuntimeClient","moxie/core/EventTarget"],function(f,e,b){function a(){this.uid=f.guid("uid_");e.call(this);this.destroy=function(){this.disconnectRuntime();this.unbindAll()}}a.prototype=b.instance;return a});p("moxie/file/FileReader","moxie/core/utils/Basic moxie/core/utils/Encode moxie/core/Exceptions moxie/core/EventTarget moxie/file/Blob moxie/file/File moxie/runtime/RuntimeTarget".split(" "),function(f,e,b,a,d,h,c){function g(){function a(f,r){function t(a){h.readyState=
g.DONE;h.error=a;h.trigger("error");s()}function s(){n.destroy();n=null;h.trigger("loadend")}function w(a){n.bind("Error",function(a,b){t(b)});n.bind("Progress",function(b){h.result=a.exec.call(n,"FileReader","getResult");h.trigger(b)});n.bind("Load",function(b){h.readyState=g.DONE;h.result=a.exec.call(n,"FileReader","getResult");h.trigger(b);s()});a.exec.call(n,"FileReader","read",f,r)}n=new c;this.convertEventPropsToHandlers(k);if(this.readyState===g.LOADING)return t(new b.DOMException(b.DOMException.INVALID_STATE_ERR));
this.readyState=g.LOADING;this.trigger("loadstart");if(r instanceof d)if(r.isDetached()){var v=r.getSource();switch(f){case "readAsText":case "readAsBinaryString":this.result=v;break;case "readAsDataURL":this.result="data:"+r.type+";base64,"+e.btoa(v)}this.readyState=g.DONE;this.trigger("load");s()}else w(n.connectRuntime(r.ruid));else t(new b.DOMException(b.DOMException.NOT_FOUND_ERR))}var h=this,n;f.extend(this,{uid:f.guid("uid_"),readyState:g.EMPTY,result:null,error:null,readAsBinaryString:function(b){a.call(this,
"readAsBinaryString",b)},readAsDataURL:function(b){a.call(this,"readAsDataURL",b)},readAsText:function(b){a.call(this,"readAsText",b)},abort:function(){this.result=null;-1===f.inArray(this.readyState,[g.EMPTY,g.DONE])&&(this.readyState===g.LOADING&&(this.readyState=g.DONE),n&&n.getRuntime().exec.call(this,"FileReader","abort"),this.trigger("abort"),this.trigger("loadend"))},destroy:function(){this.abort();n&&(n.getRuntime().exec.call(this,"FileReader","destroy"),n.disconnectRuntime());h=n=null}})}
var k="loadstart progress load abort error loadend".split(" ");g.EMPTY=0;g.LOADING=1;g.DONE=2;g.prototype=a.instance;return g});p("moxie/core/utils/Url",[],function(){var f=function(e,b){for(var a="source scheme authority userInfo user pass host port relative path directory file query fragment".split(" "),d=a.length,h={http:80,https:443},c={},g=/^(?:([^:\/?#]+):)?(?:\/\/()(?:(?:()(?:([^:@]*):?([^:@]*))?@)?([^:\/?#]*)(?::(\d*))?))?()(?:(()(?:(?:[^?#\/]*\/)*)()(?:[^?#]*))(?:\\?([^#]*))?(?:#(.*))?)/.exec(e||
"");d--;)g[d]&&(c[a[d]]=g[d]);c.scheme||(b&&"string"!==typeof b||(b=f(b||document.location.href)),c.scheme=b.scheme,c.host=b.host,c.port=b.port,a="",/^[^\/]/.test(c.path)&&(a=b.path,a=/(\/|\/[^\.]+)$/.test(a)?a+"/":a.replace(/\/[^\/]+$/,"/")),c.path=a+(c.path||""));c.port||(c.port=h[c.scheme]||80);c.port=parseInt(c.port,10);c.path||(c.path="/");delete c.source;return c};return{parseUrl:f,resolveUrl:function(e){e=f(e);return e.scheme+"://"+e.host+(e.port!=={http:80,https:443}[e.scheme]?":"+e.port:
"")+e.path+(e.query?e.query:"")},hasSameOrigin:function(e){function b(a){return[a.scheme,a.host,a.port].join("/")}"string"===typeof e&&(e=f(e));return b(f())===b(e)}}});p("moxie/file/FileReaderSync",["moxie/core/utils/Basic","moxie/runtime/RuntimeClient","moxie/core/utils/Encode"],function(f,e,b){return function(){function a(a,h){if(h.isDetached()){var c=h.getSource();switch(a){case "readAsBinaryString":return c;case "readAsDataURL":return"data:"+h.type+";base64,"+b.btoa(c);case "readAsText":for(var g=
"",k=0,f=c.length;k<f;k++)g+=String.fromCharCode(c[k]);return g}}else return c=this.connectRuntime(h.ruid).exec.call(this,"FileReaderSync","read",a,h),this.disconnectRuntime(),c}e.call(this);f.extend(this,{uid:f.guid("uid_"),readAsBinaryString:function(b){return a.call(this,"readAsBinaryString",b)},readAsDataURL:function(b){return a.call(this,"readAsDataURL",b)},readAsText:function(b){return a.call(this,"readAsText",b)}})}});p("moxie/xhr/FormData",["moxie/core/Exceptions","moxie/core/utils/Basic",
"moxie/file/Blob"],function(f,e,b){return function(){var a,d=[];e.extend(this,{append:function(h,c){var g=this,k=e.typeOf(c);c instanceof b?a={name:h,value:c}:"array"===k?(h+="[]",e.each(c,function(a){g.append(h,a)})):"object"===k?e.each(c,function(a,b){g.append(h+"["+b+"]",a)}):"null"===k||"undefined"===k||"number"===k&&isNaN(c)?g.append(h,"false"):d.push({name:h,value:c.toString()})},hasBlob:function(){return!!this.getBlob()},getBlob:function(){return a&&a.value||null},getBlobName:function(){return a&&
a.name||null},each:function(b){e.each(d,function(a){b(a.value,a.name)});a&&b(a.value,a.name)},destroy:function(){a=null;d=[]}})}});p("moxie/xhr/XMLHttpRequest","moxie/core/utils/Basic moxie/core/Exceptions moxie/core/EventTarget moxie/core/utils/Encode moxie/core/utils/Url moxie/runtime/Runtime moxie/runtime/RuntimeTarget moxie/file/Blob moxie/file/FileReaderSync moxie/xhr/FormData moxie/core/utils/Env moxie/core/utils/Mime".split(" "),function(f,e,b,a,d,h,c,g,k,r,l,n){function q(){this.uid=f.guid("uid_")}
function m(){function b(a,c){if(x.hasOwnProperty(a)){if(1===arguments.length)return l.can("define_property")?x[a]:u[a];l.can("define_property")?x[a]=c:u[a]=c}}function k(a){function d(){z&&(z.destroy(),z=null);e.dispatchEvent("loadend");e=null}function g(c){z.bind("LoadStart",function(a){b("readyState",m.LOADING);e.dispatchEvent("readystatechange");e.dispatchEvent(a);I&&e.upload.dispatchEvent(a)});z.bind("Progress",function(a){b("readyState")!==m.LOADING&&(b("readyState",m.LOADING),e.dispatchEvent("readystatechange"));
e.dispatchEvent(a)});z.bind("UploadProgress",function(a){I&&e.upload.dispatchEvent({type:"progress",lengthComputable:!1,total:a.total,loaded:a.loaded})});z.bind("Load",function(a){b("readyState",m.DONE);b("status",Number(c.exec.call(z,"XMLHttpRequest","getStatus")||0));b("statusText",t[b("status")]||"");b("response",c.exec.call(z,"XMLHttpRequest","getResponse",b("responseType")));~f.inArray(b("responseType"),["text",""])?b("responseText",b("response")):"document"===b("responseType")&&b("responseXML",
b("response"));B=c.exec.call(z,"XMLHttpRequest","getAllResponseHeaders");e.dispatchEvent("readystatechange");0<b("status")?(I&&e.upload.dispatchEvent(a),e.dispatchEvent(a)):(y=!0,e.dispatchEvent("error"));d()});z.bind("Abort",function(a){e.dispatchEvent(a);d()});z.bind("Error",function(a){y=!0;b("readyState",m.DONE);e.dispatchEvent("readystatechange");J=!0;e.dispatchEvent(a);d()});c.exec.call(z,"XMLHttpRequest","send",{url:p,method:D,async:A,user:P,password:Q,headers:E,mimeType:K,encoding:R,responseType:e.responseType,
withCredentials:e.withCredentials,options:C},a)}var e=this;(new Date).getTime();z=new c;"string"===typeof C.required_caps&&(C.required_caps=h.parseCaps(C.required_caps));C.required_caps=f.extend({},C.required_caps,{return_response_type:e.responseType});a instanceof r&&(C.required_caps.send_multipart=!0);f.isEmptyObj(E)||(C.required_caps.send_custom_headers=!0);L||(C.required_caps.do_cors=!0);C.ruid?g(z.connectRuntime(C)):(z.bind("RuntimeInit",function(a,b){g(b)}),z.bind("RuntimeError",function(a,
b){e.dispatchEvent("RuntimeError",b)}),z.connectRuntime(C))}var u=this,x={timeout:0,readyState:m.UNSENT,withCredentials:!1,status:0,statusText:"",responseType:"",responseXML:null,responseText:null,response:null},A=!0,p,D,E={},P,Q,R=null,K=null,M=!1,H=!1,I=!1,J=!1,y=!1,L=!1,C={},z,B="",F;f.extend(this,x,{uid:f.guid("uid_"),upload:new q,open:function(c,k,g,h,l){if(!c||!k)throw new e.DOMException(e.DOMException.SYNTAX_ERR);if(/[\u0100-\uffff]/.test(c)||a.utf8_encode(c)!==c)throw new e.DOMException(e.DOMException.SYNTAX_ERR);
~f.inArray(c.toUpperCase(),"CONNECT DELETE GET HEAD OPTIONS POST PUT TRACE TRACK".split(" "))&&(D=c.toUpperCase());if(~f.inArray(D,["CONNECT","TRACE","TRACK"]))throw new e.DOMException(e.DOMException.SECURITY_ERR);k=a.utf8_encode(k);c=d.parseUrl(k);L=d.hasSameOrigin(c);p=d.resolveUrl(k);if((h||l)&&!L)throw new e.DOMException(e.DOMException.INVALID_ACCESS_ERR);P=h||c.user;Q=l||c.pass;A=g||!0;if(!1===A&&(b("timeout")||b("withCredentials")||""!==b("responseType")))throw new e.DOMException(e.DOMException.INVALID_ACCESS_ERR);
M=!A;H=!1;E={};b("responseText","");b("responseXML",null);b("response",null);b("status",0);b("statusText","");b("readyState",m.OPENED);this.convertEventPropsToHandlers(["readystatechange"]);this.dispatchEvent("readystatechange")},setRequestHeader:function(c,d){if(b("readyState")!==m.OPENED||H)throw new e.DOMException(e.DOMException.INVALID_STATE_ERR);if(/[\u0100-\uffff]/.test(c)||a.utf8_encode(c)!==c)throw new e.DOMException(e.DOMException.SYNTAX_ERR);c=f.trim(c).toLowerCase();if(~f.inArray(c,"accept-charset accept-encoding access-control-request-headers access-control-request-method connection content-length cookie cookie2 content-transfer-encoding date expect host keep-alive origin referer te trailer transfer-encoding upgrade user-agent via".split(" "))||
/^(proxy\-|sec\-)/.test(c))return!1;E[c]=E[c]?E[c]+(", "+d):d;return!0},getAllResponseHeaders:function(){return B||""},getResponseHeader:function(a){a=a.toLowerCase();return y||~f.inArray(a,["set-cookie","set-cookie2"])?null:B&&""!==B&&(F||(F={},f.each(B.split(/\r\n/),function(a){a=a.split(/:\s+/);2===a.length&&(a[0]=f.trim(a[0]),F[a[0].toLowerCase()]={header:a[0],value:f.trim(a[1])})})),F.hasOwnProperty(a))?F[a].header+": "+F[a].value:null},overrideMimeType:function(a){var c;if(~f.inArray(b("readyState"),
[m.LOADING,m.DONE]))throw new e.DOMException(e.DOMException.INVALID_STATE_ERR);a=f.trim(a.toLowerCase());/;/.test(a)&&(c=a.match(/^([^;]+)(?:;\scharset\=)?(.*)$/))&&(a=c[1]);if(!n.mimes[a])throw new e.DOMException(e.DOMException.SYNTAX_ERR);},send:function(b,c){C="string"===f.typeOf(c)?{ruid:c}:c?c:{};this.convertEventPropsToHandlers(s);this.upload.convertEventPropsToHandlers(s);if(this.readyState!==m.OPENED||H)throw new e.DOMException(e.DOMException.INVALID_STATE_ERR);if(b instanceof g)C.ruid=b.ruid,
K=b.type||"application/octet-stream";else if(b instanceof r){if(b.hasBlob()){var d=b.getBlob();C.ruid=d.ruid;K=d.type||"application/octet-stream"}}else"string"===typeof b&&(R="UTF-8",K="text/plain;charset=UTF-8",b=a.utf8_encode(b));this.withCredentials||(this.withCredentials=C.required_caps&&C.required_caps.send_browser_cookies&&!L);I=!M&&this.upload.hasEventListener();y=!1;J=!b;M||(H=!0);k.call(this,b)},abort:function(){y=!0;M=!1;if(~f.inArray(b("readyState"),[m.UNSENT,m.OPENED,m.DONE]))b("readyState",
m.UNSENT);else{b("readyState",m.DONE);H=!1;if(z)z.getRuntime().exec.call(z,"XMLHttpRequest","abort",J);else throw new e.DOMException(e.DOMException.INVALID_STATE_ERR);J=!0}},destroy:function(){z&&("function"===f.typeOf(z.destroy)&&z.destroy(),z=null);this.unbindAll();this.upload&&(this.upload.unbindAll(),this.upload=null)}})}var t={100:"Continue",101:"Switching Protocols",102:"Processing",200:"OK",201:"Created",202:"Accepted",203:"Non-Authoritative Information",204:"No Content",205:"Reset Content",
206:"Partial Content",207:"Multi-Status",226:"IM Used",300:"Multiple Choices",301:"Moved Permanently",302:"Found",303:"See Other",304:"Not Modified",305:"Use Proxy",306:"Reserved",307:"Temporary Redirect",400:"Bad Request",401:"Unauthorized",402:"Payment Required",403:"Forbidden",404:"Not Found",405:"Method Not Allowed",406:"Not Acceptable",407:"Proxy Authentication Required",408:"Request Timeout",409:"Conflict",410:"Gone",411:"Length Required",412:"Precondition Failed",413:"Request Entity Too Large",
414:"Request-URI Too Long",415:"Unsupported Media Type",416:"Requested Range Not Satisfiable",417:"Expectation Failed",422:"Unprocessable Entity",423:"Locked",424:"Failed Dependency",426:"Upgrade Required",500:"Internal Server Error",501:"Not Implemented",502:"Bad Gateway",503:"Service Unavailable",504:"Gateway Timeout",505:"HTTP Version Not Supported",506:"Variant Also Negotiates",507:"Insufficient Storage",510:"Not Extended"};q.prototype=b.instance;var s="loadstart progress abort error load timeout loadend".split(" ");
m.UNSENT=0;m.OPENED=1;m.HEADERS_RECEIVED=2;m.LOADING=3;m.DONE=4;m.prototype=b.instance;return m});p("moxie/runtime/Transporter",["moxie/core/utils/Basic","moxie/core/utils/Encode","moxie/runtime/RuntimeClient","moxie/core/EventTarget"],function(f,e,b,a){function d(){function a(b,g){var h=this;k=g;h.bind("TransportingProgress",function(a){n=a.loaded;n<l&&-1===f.inArray(h.state,[d.IDLE,d.DONE])&&c.call(h)},999);h.bind("TransportingComplete",function(){n=l;h.state=d.DONE;r=null;h.result=k.exec.call(h,
"Transporter","getAsBlob",b||"")},999);h.state=d.BUSY;h.trigger("TransportingStarted");c.call(h)}function c(){var a;a=l-n;q>a&&(q=a);a=e.btoa(r.substr(n,q));k.exec.call(this,"Transporter","receive",a,l)}var g,k,r,l,n,q;b.call(this);f.extend(this,{uid:f.guid("uid_"),state:d.IDLE,result:null,transport:function(b,c,d){var k=this;d=f.extend({chunk_size:204798},d);if(g=d.chunk_size%3)d.chunk_size+=3-g;q=d.chunk_size;l=n=0;r=this.result=null;r=b;l=b.length;if("string"===f.typeOf(d)||d.ruid)a.call(k,c,this.connectRuntime(d));
else{var e=function(b,d){k.unbind("RuntimeInit",e);a.call(k,c,d)};this.bind("RuntimeInit",e);this.connectRuntime(d)}},abort:function(){this.state=d.IDLE;k&&(k.exec.call(this,"Transporter","clear"),this.trigger("TransportingAborted"));l=n=0;r=this.result=null},destroy:function(){this.unbindAll();k=null;this.disconnectRuntime();l=n=0;r=this.result=null}})}d.IDLE=0;d.BUSY=1;d.DONE=2;d.prototype=a.instance;return d});p("moxie/image/Image","moxie/core/utils/Basic moxie/core/utils/Dom moxie/core/Exceptions moxie/file/FileReaderSync moxie/xhr/XMLHttpRequest moxie/runtime/Runtime moxie/runtime/RuntimeClient moxie/runtime/Transporter moxie/core/utils/Env moxie/core/EventTarget moxie/file/Blob moxie/file/File moxie/core/utils/Encode".split(" "),
function(f,e,b,a,d,h,c,g,k,r,l,n,q){function m(){function a(c){var d=f.typeOf(c);try{if(c instanceof m){if(!c.size)throw new b.DOMException(b.DOMException.INVALID_STATE_ERR);r.apply(this,arguments)}else if(c instanceof l){if(!~f.inArray(c.type,["image/jpeg","image/png"]))throw new b.ImageError(b.ImageError.WRONG_FORMAT);v.apply(this,arguments)}else if(-1!==f.inArray(d,["blob","file"]))a.call(this,new n(null,c),arguments[1]);else if("string"===d)/^data:[^;]*;base64,/.test(c)?a.call(this,new l(null,
{data:c}),arguments[1]):u.apply(this,arguments);else if("node"===d&&"img"===c.nodeName.toLowerCase())a.call(this,c.src,arguments[1]);else throw new b.DOMException(b.DOMException.TYPE_MISMATCH_ERR);}catch(k){this.trigger("error",k.code)}}function r(a,b){var c=this.connectRuntime(a.ruid);this.ruid=c.uid;c.exec.call(this,"Image","loadFromImage",a,"undefined"===f.typeOf(b)?!0:b)}function v(a,b){function c(b){d.ruid=b.uid;b.exec.call(d,"Image","loadFromBlob",a)}var d=this;d.name=a.name||"";a.isDetached()?
(this.bind("RuntimeInit",function(a,b){c(b)}),b&&"string"===typeof b.required_caps&&(b.required_caps=h.parseCaps(b.required_caps)),this.connectRuntime(f.extend({required_caps:{access_image_binary:!0,resize_image:!0}},b))):c(this.connectRuntime(a.ruid))}function u(a,b){var c=this,k;k=new d;k.open("get",a);k.responseType="blob";k.onprogress=function(a){c.trigger(a)};k.onload=function(){v.call(c,k.response,!0)};k.onerror=function(a){c.trigger(a)};k.onloadend=function(){k.destroy()};k.bind("RuntimeError",
function(a,b){c.trigger("RuntimeError",b)});k.send(null,b)}c.call(this);f.extend(this,{uid:f.guid("uid_"),ruid:null,name:"",size:0,width:0,height:0,type:"",meta:{},clone:function(){this.load.apply(this,arguments)},load:function(){this.bind("Load Resize",function(){var a=void 0,a=this.getRuntime().exec.call(this,"Image","getInfo");this.size=a.size;this.width=a.width;this.height=a.height;this.type=a.type;this.meta=a.meta;""===this.name&&(this.name=a.name)},999);this.convertEventPropsToHandlers(t);a.apply(this,
arguments)},downsize:function(a,c,d,k){var g={width:this.width,height:this.height,crop:!1,preserveHeaders:!0};a="object"===typeof a?f.extend(g,a):f.extend(g,{width:a,height:c,crop:d,preserveHeaders:k});try{if(!this.size)throw new b.DOMException(b.DOMException.INVALID_STATE_ERR);if(this.width>m.MAX_RESIZE_WIDTH||this.height>m.MAX_RESIZE_HEIGHT)throw new b.ImageError(b.ImageError.MAX_RESOLUTION_ERR);this.getRuntime().exec.call(this,"Image","downsize",a.width,a.height,a.crop,a.preserveHeaders)}catch(h){this.trigger("error",
h.code)}},crop:function(a,b,c){this.downsize(a,b,!0,c)},getAsCanvas:function(){if(!k.can("create_canvas"))throw new b.RuntimeError(b.RuntimeError.NOT_SUPPORTED_ERR);return this.connectRuntime(this.ruid).exec.call(this,"Image","getAsCanvas")},getAsBlob:function(a,c){if(!this.size)throw new b.DOMException(b.DOMException.INVALID_STATE_ERR);a||(a="image/jpeg");"image/jpeg"!==a||c||(c=90);return this.getRuntime().exec.call(this,"Image","getAsBlob",a,c)},getAsDataURL:function(a,c){if(!this.size)throw new b.DOMException(b.DOMException.INVALID_STATE_ERR);
return this.getRuntime().exec.call(this,"Image","getAsDataURL",a,c)},getAsBinaryString:function(a,b){var c=this.getAsDataURL(a,b);return q.atob(c.substring(c.indexOf("base64,")+7))},embed:function(a,c){function d(){if(k.can("create_canvas")){var c=l.getAsCanvas();if(c){a.appendChild(c);c=null;l.destroy();h.trigger("embedded");return}}c=l.getAsDataURL(r,n);if(!c)throw new b.ImageError(b.ImageError.WRONG_FORMAT);if(k.can("use_data_uri_of",c.length))a.innerHTML='<img src="'+c+'" width="'+l.width+'" height="'+
l.height+'" />',l.destroy(),h.trigger("embedded");else{var e=new g;e.bind("TransportingComplete",function(){u=h.connectRuntime(this.result.ruid);h.bind("Embedded",function(){f.extend(u.getShimContainer().style,{top:"0px",left:"0px",width:l.width+"px",height:l.height+"px"});u=null},999);u.exec.call(h,"ImageView","display",this.result.uid,v,t);l.destroy()});e.transport(q.atob(c.substring(c.indexOf("base64,")+7)),r,f.extend({},w,{required_caps:{display_media:!0},runtime_order:"flash,silverlight",container:a}))}}
var h=this,l,r,n,s,w=c||{},v=this.width,t=this.height,u;try{if(!(a=e.get(a)))throw new b.DOMException(b.DOMException.INVALID_NODE_TYPE_ERR);if(!this.size)throw new b.DOMException(b.DOMException.INVALID_STATE_ERR);if(this.width>m.MAX_RESIZE_WIDTH||this.height>m.MAX_RESIZE_HEIGHT)throw new b.ImageError(b.ImageError.MAX_RESOLUTION_ERR);r=w.type||this.type||"image/jpeg";n=w.quality||90;s="undefined"!==f.typeOf(w.crop)?w.crop:!1;if(w.width)v=w.width,t=w.height||v;else{var p=e.getSize(a);p.w&&p.h&&(v=p.w,
t=p.h)}l=new m;l.bind("Resize",function(){d.call(h)});l.bind("Load",function(){l.downsize(v,t,s,!1)});l.clone(this,!1);return l}catch(y){this.trigger("error",y.code)}},destroy:function(){this.ruid&&(this.getRuntime().exec.call(this,"Image","destroy"),this.disconnectRuntime());this.unbindAll()}})}var t=["progress","load","error","resize","embedded"];m.MAX_RESIZE_WIDTH=6500;m.MAX_RESIZE_HEIGHT=6500;m.prototype=r.instance;return m});p("moxie/runtime/html5/Runtime",["moxie/core/utils/Basic","moxie/core/Exceptions",
"moxie/runtime/Runtime","moxie/core/utils/Env"],function(f,e,b,a){var d={};b.addConstructor("html5",function(h,c,g){var k=this,e=b.capTest,l=b.capTrue;g=f.extend({access_binary:e(window.FileReader||window.File&&window.File.getAsDataURL),access_image_binary:function(){return k.can("access_binary")&&!!d.Image},display_media:e(a.can("create_canvas")||a.can("use_data_uri_over32kb")),do_cors:e(window.XMLHttpRequest&&"withCredentials"in new XMLHttpRequest),drag_and_drop:e(function(){var b=document.createElement("div");
return("draggable"in b||"ondragstart"in b&&"ondrop"in b)&&("IE"!==a.browser||9<a.version)}()),filter_by_extension:e("Chrome"===a.browser&&28<=a.version||"IE"===a.browser&&10<=a.version),return_response_headers:l,return_response_type:function(b){return"json"===b&&window.JSON?!0:a.can("return_response_type",b)},return_status_code:l,report_upload_progress:e(window.XMLHttpRequest&&(new XMLHttpRequest).upload),resize_image:function(){return k.can("access_binary")&&a.can("create_canvas")},select_file:function(){return a.can("use_fileinput")&&
window.File},select_folder:function(){return k.can("select_file")&&"Chrome"===a.browser&&21<=a.version},select_multiple:function(){return k.can("select_file")&&!("Safari"===a.browser&&"Windows"===a.os)&&!("iOS"===a.os&&a.verComp(a.osVersion,"7.0.4","<"))},send_binary_string:e(window.XMLHttpRequest&&((new XMLHttpRequest).sendAsBinary||window.Uint8Array&&window.ArrayBuffer)),send_custom_headers:e(window.XMLHttpRequest),send_multipart:function(){return!!(window.XMLHttpRequest&&(new XMLHttpRequest).upload&&
window.FormData)||k.can("send_binary_string")},slice_blob:e(window.File&&(File.prototype.mozSlice||File.prototype.webkitSlice||File.prototype.slice)),stream_upload:function(){return k.can("slice_blob")&&k.can("send_multipart")},summon_file_dialog:e("Firefox"===a.browser&&4<=a.version||"Opera"===a.browser&&12<=a.version||"IE"===a.browser&&10<=a.version||!!~f.inArray(a.browser,["Chrome","Safari"])),upload_filesize:l},g);b.call(this,h,c||"html5",g);f.extend(this,{init:function(){this.trigger("Init")},
destroy:function(a){return function(){a.call(k);a=k=null}}(this.destroy)});f.extend(this.getShim(),d)});return d});p("moxie/runtime/html5/file/Blob",["moxie/runtime/html5/Runtime","moxie/file/Blob"],function(f,e){return f.Blob=function(){function b(a,b,h){var c;if(window.File.prototype.slice)try{return a.slice(),a.slice(b,h)}catch(g){return a.slice(b,h-b)}else return(c=window.File.prototype.webkitSlice||window.File.prototype.mozSlice)?c.call(a,b,h):null}this.slice=function(){return new e(this.getRuntime().uid,
b.apply(this,arguments))}}});p("moxie/core/utils/Events",["moxie/core/utils/Basic"],function(f){function e(){this.returnValue=!1}function b(){this.cancelBubble=!0}var a={},d="moxie_"+f.guid(),h=function(b,g,k){var h;g=g.toLowerCase();if(b[d]&&a[b[d]]&&a[b[d]][g]){h=a[b[d]][g];for(var e=h.length-1;0<=e;e--)if(h[e].orig===k||h[e].key===k)if(b.removeEventListener?b.removeEventListener(g,h[e].func,!1):b.detachEvent&&b.detachEvent("on"+g,h[e].func),h[e].orig=null,h[e].func=null,h.splice(e,1),void 0!==
k)break;h.length||delete a[b[d]][g];if(f.isEmptyObj(a[b[d]])){delete a[b[d]];try{delete b[d]}catch(n){b[d]=void 0}}}};return{addEvent:function(c,g,k,h){var l;g=g.toLowerCase();c.addEventListener?(l=k,c.addEventListener(g,l,!1)):c.attachEvent&&(l=function(){var a=window.event;a.target||(a.target=a.srcElement);a.preventDefault=e;a.stopPropagation=b;k(a)},c.attachEvent("on"+g,l));c[d]||(c[d]=f.guid());a.hasOwnProperty(c[d])||(a[c[d]]={});c=a[c[d]];c.hasOwnProperty(g)||(c[g]=[]);c[g].push({func:l,orig:k,
key:h})},removeEvent:h,removeAllEvents:function(b,g){b&&b[d]&&f.each(a[b[d]],function(a,d){h(b,d,g)})}}});p("moxie/runtime/html5/file/FileInput","moxie/runtime/html5/Runtime moxie/core/utils/Basic moxie/core/utils/Dom moxie/core/utils/Events moxie/core/utils/Mime moxie/core/utils/Env".split(" "),function(f,e,b,a,d,h){return f.FileInput=function(){var c=[],g;e.extend(this,{init:function(k){var f=this,l=f.getRuntime(),n,q,m;g=k;c=[];k=g.accept.mimes||d.extList2mimes(g.accept,l.can("filter_by_extension"));
n=l.getShimContainer();n.innerHTML='<input id="'+l.uid+'" type="file" style="font-size:999px;opacity:0;"'+(g.multiple&&l.can("select_multiple")?"multiple":"")+(g.directory&&l.can("select_folder")?"webkitdirectory directory":"")+(k?' accept="'+k.join(",")+'"':"")+" />";k=b.get(l.uid);e.extend(k.style,{position:"absolute",top:0,left:0,width:"100%",height:"100%"});q=b.get(g.browse_button);l.can("summon_file_dialog")&&("static"===b.getStyle(q,"position")&&(q.style.position="relative"),m=parseInt(b.getStyle(q,
"z-index"),10)||1,q.style.zIndex=m,n.style.zIndex=m-1,a.addEvent(q,"click",function(a){var c=b.get(l.uid);c&&!c.disabled&&c.click();a.preventDefault()},f.uid));n=l.can("summon_file_dialog")?q:n;a.addEvent(n,"mouseover",function(){f.trigger("mouseenter")},f.uid);a.addEvent(n,"mouseout",function(){f.trigger("mouseleave")},f.uid);a.addEvent(n,"mousedown",function(){f.trigger("mousedown")},f.uid);a.addEvent(b.get(g.container),"mouseup",function(){f.trigger("mouseup")},f.uid);k.onchange=function s(){c=
[];g.directory?e.each(this.files,function(a){"."!==a.name&&c.push(a)}):c=[].slice.call(this.files);if("IE"!==h.browser&&"IEMobile"!==h.browser)this.value="";else{var a=this.cloneNode(!0);this.parentNode.replaceChild(a,this);a.onchange=s}f.trigger("change")};f.trigger({type:"ready",async:!0});n=null},getFiles:function(){return c},disable:function(a){var c=this.getRuntime();if(c=b.get(c.uid))c.disabled=!!a},destroy:function(){var d=this.getRuntime(),h=d.getShim(),d=d.getShimContainer();a.removeAllEvents(d,
this.uid);a.removeAllEvents(g&&b.get(g.container),this.uid);a.removeAllEvents(g&&b.get(g.browse_button),this.uid);d&&(d.innerHTML="");h.removeInstance(this.uid);c=g=null}})}});p("moxie/runtime/html5/file/FileDrop",["moxie/runtime/html5/Runtime","moxie/core/utils/Basic","moxie/core/utils/Dom","moxie/core/utils/Events","moxie/core/utils/Mime"],function(f,e,b,a,d){return f.FileDrop=function(){function h(a){if(!a.dataTransfer||!a.dataTransfer.types)return!1;a=e.toArray(a.dataTransfer.types||[]);return-1!==
e.inArray("Files",a)||-1!==e.inArray("public.file-url",a)||-1!==e.inArray("application/x-moz-file",a)}function c(a){for(var b=[],c=0;c<a.length;c++)[].push.apply(b,a[c].extensions.split(/\s*,\s*/));return-1===e.inArray("*",b)?b:[]}function g(a){if(!m.length)return!0;a=d.getFileExtension(a.name);return!a||-1!==e.inArray(a,m)}function k(a,b){var c=[];e.each(a,function(a){var b=a.webkitGetAsEntry();b&&(b.isFile?(a=a.getAsFile(),g(a)&&q.push(a)):c.push(b))});c.length?f(c,b):b()}function f(a,b){var c=
[];e.each(a,function(a){c.push(function(b){l(a,b)})});e.inSeries(c,function(){b()})}function l(a,b){a.isFile?a.file(function(a){g(a)&&q.push(a);b()},function(){b()}):a.isDirectory?n(a,b):b()}function n(a,b){function c(a){k.readEntries(function(b){b.length?([].push.apply(d,b),c(a)):a()},a)}var d=[],k=a.createReader();c(function(){f(d,b)})}var q=[],m=[],t;e.extend(this,{init:function(b){var d=this;t=b;m=c(t.accept);b=t.container;a.addEvent(b,"dragover",function(a){h(a)&&(a.preventDefault(),a.dataTransfer.dropEffect=
"copy")},d.uid);a.addEvent(b,"drop",function(a){h(a)&&(a.preventDefault(),q=[],a.dataTransfer.items&&a.dataTransfer.items[0].webkitGetAsEntry?k(a.dataTransfer.items,function(){d.trigger("drop")}):(e.each(a.dataTransfer.files,function(a){g(a)&&q.push(a)}),d.trigger("drop")))},d.uid);a.addEvent(b,"dragenter",function(a){d.trigger("dragenter")},d.uid);a.addEvent(b,"dragleave",function(a){d.trigger("dragleave")},d.uid)},getFiles:function(){return q},destroy:function(){a.removeAllEvents(t&&b.get(t.container),
this.uid);q=m=t=null}})}});p("moxie/runtime/html5/file/FileReader",["moxie/runtime/html5/Runtime","moxie/core/utils/Encode","moxie/core/utils/Basic"],function(f,e,b){return f.FileReader=function(){var a,d=!1;b.extend(this,{read:function(h,c){var g=this;a=new window.FileReader;a.addEventListener("progress",function(a){g.trigger(a)});a.addEventListener("load",function(a){g.trigger(a)});a.addEventListener("error",function(b){g.trigger(b,a.error)});a.addEventListener("loadend",function(){a=null});"function"===
b.typeOf(a[h])?(d=!1,a[h](c.getSource())):"readAsBinaryString"===h&&(d=!0,a.readAsDataURL(c.getSource()))},getResult:function(){var b;a&&a.result?d?(b=a.result,b=e.atob(b.substring(b.indexOf("base64,")+7))):b=a.result:b=null;return b},abort:function(){a&&a.abort()},destroy:function(){a=null}})}});p("moxie/runtime/html5/xhr/XMLHttpRequest","moxie/runtime/html5/Runtime moxie/core/utils/Basic moxie/core/utils/Mime moxie/core/utils/Url moxie/file/File moxie/file/Blob moxie/xhr/FormData moxie/core/Exceptions moxie/core/utils/Env".split(" "),
function(f,e,b,a,d,h,c,g,k){return f.XMLHttpRequest=function(){function f(a,b){var c=this,d,k;d=b.getBlob().getSource();k=new window.FileReader;k.onload=function(){b.append(b.getBlobName(),new h(null,{type:d.type,data:k.result}));q.send.call(c,a,b)};k.readAsBinaryString(d)}function l(){if(!window.XMLHttpRequest||"IE"===k.browser&&8>k.version){var a;a:{for(var b=["Msxml2.XMLHTTP.6.0","Microsoft.XMLHTTP"],c=0;c<b.length;c++)try{a=new ActiveXObject(b[c]);break a}catch(d){}a=void 0}return a}return new window.XMLHttpRequest}
function n(a){var b="----moxieboundary"+(new Date).getTime(),c="";if(!this.getRuntime().can("send_binary_string"))throw new g.RuntimeError(g.RuntimeError.NOT_SUPPORTED_ERR);m.setRequestHeader("Content-Type","multipart/form-data; boundary="+b);a.each(function(a,d){c=a instanceof h?c+("--"+b+'\r\nContent-Disposition: form-data; name="'+d+'"; filename="'+unescape(encodeURIComponent(a.name||"blob"))+'"\r\nContent-Type: '+(a.type||"application/octet-stream")+"\r\n\r\n"+a.getSource()+"\r\n"):c+("--"+b+
'\r\nContent-Disposition: form-data; name="'+d+'"\r\n\r\n'+unescape(encodeURIComponent(a))+"\r\n")});return c+="--"+b+"--\r\n"}var q=this,m,t;e.extend(this,{send:function(b,d){var g=this,q="Mozilla"===k.browser&&4<=k.version&&7>k.version,p="Android Browser"===k.browser,A=!1;t=b.url.replace(/^.+?\/([\w\-\.]+)$/,"$1").toLowerCase();m=l();m.open(b.method,b.url,b.async,b.user,b.password);if(d instanceof h)d.isDetached()&&(A=!0),d=d.getSource();else if(d instanceof c){if(d.hasBlob())if(d.getBlob().isDetached())d=
n.call(g,d),A=!0;else if((q||p)&&"blob"===e.typeOf(d.getBlob().getSource())&&window.FileReader){f.call(g,b,d);return}if(d instanceof c){var O=new window.FormData;d.each(function(a,b){a instanceof h?O.append(b,a.getSource()):O.append(b,a)});d=O}}m.upload?(b.withCredentials&&(m.withCredentials=!0),m.addEventListener("load",function(a){g.trigger(a)}),m.addEventListener("error",function(a){g.trigger(a)}),m.addEventListener("progress",function(a){g.trigger(a)}),m.upload.addEventListener("progress",function(a){g.trigger({type:"UploadProgress",
loaded:a.loaded,total:a.total})})):m.onreadystatechange=function(){switch(m.readyState){case 3:var c,d;try{a.hasSameOrigin(b.url)&&(c=m.getResponseHeader("Content-Length")||0),m.responseText&&(d=m.responseText.length)}catch(k){c=d=0}g.trigger({type:"progress",lengthComputable:!!c,total:parseInt(c,10),loaded:d});break;case 4:m.onreadystatechange=function(){},0===m.status?g.trigger("error"):g.trigger("load")}};e.isEmptyObj(b.headers)||e.each(b.headers,function(a,b){m.setRequestHeader(b,a)});""!==b.responseType&&
"responseType"in m&&("json"!==b.responseType||k.can("return_response_type","json")?m.responseType=b.responseType:m.responseType="text");A?m.sendAsBinary?m.sendAsBinary(d):function(){for(var a=new Uint8Array(d.length),b=0;b<d.length;b++)a[b]=d.charCodeAt(b)&255;m.send(a.buffer)}():m.send(d);g.trigger("loadstart")},getStatus:function(){try{if(m)return m.status}catch(a){}return 0},getResponse:function(a){var c=this.getRuntime();try{switch(a){case "blob":var g=new d(c.uid,m.response),h=m.getResponseHeader("Content-Disposition");
if(h){var f=h.match(/filename=([\'\"'])([^\1]+)\1/);f&&(t=f[2])}g.name=t;g.type||(g.type=b.getFileMime(t));return g;case "json":return k.can("return_response_type","json")?m.response:200===m.status&&window.JSON?JSON.parse(m.responseText):null;case "document":var e;var l=m.responseXML,q=m.responseText;"IE"===k.browser&&q&&l&&!l.documentElement&&/[^\/]+\/[^\+]+\+xml/.test(m.getResponseHeader("Content-Type"))&&(l=new window.ActiveXObject("Microsoft.XMLDOM"),l.async=!1,l.validateOnParse=!1,l.loadXML(q));
e=l&&("IE"===k.browser&&0!==l.parseError||!l.documentElement||"parsererror"===l.documentElement.tagName)?null:l;return e;default:return""!==m.responseText?m.responseText:null}}catch(n){return null}},getAllResponseHeaders:function(){try{return m.getAllResponseHeaders()}catch(a){}return""},abort:function(){m&&m.abort()},destroy:function(){q=t=null}})}});p("moxie/runtime/html5/utils/BinaryReader",[],function(){return function(){function f(d,h){var c=b?0:-8*(h-1),g=0,k;for(k=0;k<h;k++)g|=a.charCodeAt(d+
k)<<Math.abs(c+8*k);return g}function e(b,h,c){c=3===arguments.length?c:a.length-h-1;a=a.substr(0,h)+b+a.substr(c+h)}var b=!1,a;return{II:function(a){if(a===y)return b;b=a},init:function(d){b=!1;a=d},SEGMENT:function(b,h,c){switch(arguments.length){case 1:return a.substr(b,a.length-b-1);case 2:return a.substr(b,h);case 3:e(c,b,h);break;default:return a}},BYTE:function(a){return f(a,1)},SHORT:function(a){return f(a,2)},LONG:function(a,h){if(h===y)return f(a,4);var c="",g=b?0:-24,k;for(k=0;4>k;k++)c+=
String.fromCharCode(h>>Math.abs(g+8*k)&255);e(c,a,4)},SLONG:function(a){a=f(a,4);return 2147483647<a?a-4294967296:a},STRING:function(a,b){var c="";for(b+=a;a<b;a++)c+=String.fromCharCode(f(a,1));return c}}}});p("moxie/runtime/html5/image/JPEGHeaders",["moxie/runtime/html5/utils/BinaryReader"],function(f){return function b(a){var d=[],h,c,g,k=0;h=new f;h.init(a);if(65496===h.SHORT(0)){for(c=2;c<=a.length;)if(g=h.SHORT(c),65488<=g&&65495>=g)c+=2;else{if(65498===g||65497===g)break;k=h.SHORT(c+2)+2;65505<=
g&&65519>=g&&d.push({hex:g,name:"APP"+(g&15),start:c,length:k,segment:h.SEGMENT(c,k)});c+=k}h.init(null);return{headers:d,restore:function(a){var b;h.init(a);c=65504==h.SHORT(2)?4+h.SHORT(4):2;b=0;for(a=d.length;b<a;b++)h.SEGMENT(c,0,d[b].segment),c+=d[b].length;a=h.SEGMENT();h.init(null);return a},strip:function(a){var c,d;d=new b(a);c=d.headers;d.purge();h.init(a);for(a=c.length;a--;)h.SEGMENT(c[a].start,c[a].length,"");a=h.SEGMENT();h.init(null);return a},get:function(a){for(var b=[],c=0,k=d.length;c<
k;c++)d[c].name===a.toUpperCase()&&b.push(d[c].segment);return b},set:function(a,b){var c=[],k,g,h;"string"===typeof b?c.push(b):c=b;k=g=0;for(h=d.length;k<h&&!(d[k].name===a.toUpperCase()&&(d[k].segment=c[g],d[k].length=c[g].length,g++),g>=c.length);k++);},purge:function(){d=[];h.init(null);h=null}}}}});p("moxie/runtime/html5/image/ExifParser",["moxie/core/utils/Basic","moxie/runtime/html5/utils/BinaryReader"],function(f,e){return function(){function b(b,d){var h=a.SHORT(b),f,e,m,t,s,w=[],v={};for(f=
0;f<h;f++)if(s=b+12*f+2,m=d[a.SHORT(s)],m!==y){e=a.SHORT(s+=2);t=a.LONG(s+=2);s+=4;w=[];switch(e){case 1:case 7:4<t&&(s=a.LONG(s)+c.tiffHeader);for(e=0;e<t;e++)w[e]=a.BYTE(s+e);break;case 2:4<t&&(s=a.LONG(s)+c.tiffHeader);v[m]=a.STRING(s,t-1);continue;case 3:2<t&&(s=a.LONG(s)+c.tiffHeader);for(e=0;e<t;e++)w[e]=a.SHORT(s+2*e);break;case 4:1<t&&(s=a.LONG(s)+c.tiffHeader);for(e=0;e<t;e++)w[e]=a.LONG(s+4*e);break;case 5:s=a.LONG(s)+c.tiffHeader;for(e=0;e<t;e++)w[e]=a.LONG(s+4*e)/a.LONG(s+4*e+4);break;
case 9:s=a.LONG(s)+c.tiffHeader;for(e=0;e<t;e++)w[e]=a.SLONG(s+4*e);break;case 10:s=a.LONG(s)+c.tiffHeader;for(e=0;e<t;e++)w[e]=a.SLONG(s+4*e)/a.SLONG(s+4*e+4);break;default:continue}t=1==t?w[0]:w;g.hasOwnProperty(m)&&"object"!=typeof t?v[m]=g[m][t]:v[m]=t}return v}var a,d,h,c={},g;a=new e;d={tiff:{274:"Orientation",270:"ImageDescription",271:"Make",272:"Model",305:"Software",34665:"ExifIFDPointer",34853:"GPSInfoIFDPointer"},exif:{36864:"ExifVersion",40961:"ColorSpace",40962:"PixelXDimension",40963:"PixelYDimension",
36867:"DateTimeOriginal",33434:"ExposureTime",33437:"FNumber",34855:"ISOSpeedRatings",37377:"ShutterSpeedValue",37378:"ApertureValue",37383:"MeteringMode",37384:"LightSource",37385:"Flash",37386:"FocalLength",41986:"ExposureMode",41987:"WhiteBalance",41990:"SceneCaptureType",41988:"DigitalZoomRatio",41992:"Contrast",41993:"Saturation",41994:"Sharpness"},gps:{0:"GPSVersionID",1:"GPSLatitudeRef",2:"GPSLatitude",3:"GPSLongitudeRef",4:"GPSLongitude"}};g={ColorSpace:{1:"sRGB",0:"Uncalibrated"},MeteringMode:{0:"Unknown",
1:"Average",2:"CenterWeightedAverage",3:"Spot",4:"MultiSpot",5:"Pattern",6:"Partial",255:"Other"},LightSource:{1:"Daylight",2:"Fliorescent",3:"Tungsten",4:"Flash",9:"Fine weather",10:"Cloudy weather",11:"Shade",12:"Daylight fluorescent (D 5700 - 7100K)",13:"Day white fluorescent (N 4600 -5400K)",14:"Cool white fluorescent (W 3900 - 4500K)",15:"White fluorescent (WW 3200 - 3700K)",17:"Standard light A",18:"Standard light B",19:"Standard light C",20:"D55",21:"D65",22:"D75",23:"D50",24:"ISO studio tungsten",
255:"Other"},Flash:{0:"Flash did not fire.",1:"Flash fired.",5:"Strobe return light not detected.",7:"Strobe return light detected.",9:"Flash fired, compulsory flash mode",13:"Flash fired, compulsory flash mode, return light not detected",15:"Flash fired, compulsory flash mode, return light detected",16:"Flash did not fire, compulsory flash mode",24:"Flash did not fire, auto mode",25:"Flash fired, auto mode",29:"Flash fired, auto mode, return light not detected",31:"Flash fired, auto mode, return light detected",
32:"No flash function",65:"Flash fired, red-eye reduction mode",69:"Flash fired, red-eye reduction mode, return light not detected",71:"Flash fired, red-eye reduction mode, return light detected",73:"Flash fired, compulsory flash mode, red-eye reduction mode",77:"Flash fired, compulsory flash mode, red-eye reduction mode, return light not detected",79:"Flash fired, compulsory flash mode, red-eye reduction mode, return light detected",89:"Flash fired, auto mode, red-eye reduction mode",93:"Flash fired, auto mode, return light not detected, red-eye reduction mode",
95:"Flash fired, auto mode, return light detected, red-eye reduction mode"},ExposureMode:{0:"Auto exposure",1:"Manual exposure",2:"Auto bracket"},WhiteBalance:{0:"Auto white balance",1:"Manual white balance"},SceneCaptureType:{0:"Standard",1:"Landscape",2:"Portrait",3:"Night scene"},Contrast:{0:"Normal",1:"Soft",2:"Hard"},Saturation:{0:"Normal",1:"Low saturation",2:"High saturation"},Sharpness:{0:"Normal",1:"Soft",2:"Hard"},GPSLatitudeRef:{N:"North latitude",S:"South latitude"},GPSLongitudeRef:{E:"East longitude",
W:"West longitude"}};return{init:function(k){c={tiffHeader:10};if(k===y||!k.length)return!1;a.init(k);return 65505===a.SHORT(0)&&"EXIF\x00"===a.STRING(4,5).toUpperCase()?(k=c.tiffHeader,a.II(18761==a.SHORT(k)),42!==a.SHORT(k+=2)?k=!1:(c.IFD0=c.tiffHeader+a.LONG(k+2),h=b(c.IFD0,d.tiff),"ExifIFDPointer"in h&&(c.exifIFD=c.tiffHeader+h.ExifIFDPointer,delete h.ExifIFDPointer),"GPSInfoIFDPointer"in h&&(c.gpsIFD=c.tiffHeader+h.GPSInfoIFDPointer,delete h.GPSInfoIFDPointer),k=!0),k):!1},TIFF:function(){return h},
EXIF:function(){var a;a=b(c.exifIFD,d.exif);if(a.ExifVersion&&"array"===f.typeOf(a.ExifVersion)){for(var g=0,e="";g<a.ExifVersion.length;g++)e+=String.fromCharCode(a.ExifVersion[g]);a.ExifVersion=e}return a},GPS:function(){var a;a=b(c.gpsIFD,d.gps);a.GPSVersionID&&"array"===f.typeOf(a.GPSVersionID)&&(a.GPSVersionID=a.GPSVersionID.join("."));return a},setExif:function(b,g){if("PixelXDimension"!==b&&"PixelYDimension"!==b)return!1;var e;e=b;var h,f,m,t=0;if("string"===typeof e)for(f in h=d.exif,h)if(h[f]===
e){e=f;break}h=c.exifIFD;f=a.SHORT(h);for(var s=0;s<f;s++)if(m=h+12*s+2,a.SHORT(m)==e){t=m+8;break}t?(a.LONG(t,g),e=!0):e=!1;return e},getBinary:function(){return a.SEGMENT()},purge:function(){a.init(null);a=h=null;c={}}}}});p("moxie/runtime/html5/image/JPEG",["moxie/core/utils/Basic","moxie/core/Exceptions","moxie/runtime/html5/image/JPEGHeaders","moxie/runtime/html5/utils/BinaryReader","moxie/runtime/html5/image/ExifParser"],function(f,e,b,a,d){return function(h){var c,g,k,r,l,n;c=h;g=new a;g.init(c);
if(65496!==g.SHORT(0))throw new e.ImageError(e.ImageError.WRONG_FORMAT);k=new b(h);r=new d;n=!!r.init(k.get("app1")[0]);l=function(){for(var a=0,b;a<=c.length;){b=g.SHORT(a+=2);if(65472<=b&&65475>=b)return a+=5,{height:g.SHORT(a),width:g.SHORT(a+2)};b=g.SHORT(a+=2);a+=b-2}return null}.call(this);f.extend(this,{type:"image/jpeg",size:c.length,width:l&&l.width||0,height:l&&l.height||0,setExif:function(a,b){if(!n)return!1;"object"===f.typeOf(a)?f.each(a,function(a,b){r.setExif(b,a)}):r.setExif(a,b);
k.set("app1",r.getBinary())},writeHeaders:function(){return arguments.length?k.restore(arguments[0]):c=k.restore(c)},stripHeaders:function(a){return k.strip(a)},purge:function(){r&&k&&g&&(r.purge(),k.purge(),g.init(null),c=l=k=r=g=null)}});n&&(this.meta={tiff:r.TIFF(),exif:r.EXIF(),gps:r.GPS()})}});p("moxie/runtime/html5/image/PNG",["moxie/core/Exceptions","moxie/core/utils/Basic","moxie/runtime/html5/utils/BinaryReader"],function(f,e,b){return function(a){function d(){c&&(c.init(null),h=g=c=null)}
var h,c,g;h=a;c=new b;c.init(h);(function(){for(var a=0,b=0,d=[35152,20039,3338,6666],b=0;b<d.length;b++,a+=2)if(d[b]!=c.SHORT(a))throw new f.ImageError(f.ImageError.WRONG_FORMAT);})();g=function(){var a=8,b,d,g;b=c.LONG(a);d=c.STRING(a+=4,4);g=a+=4;c.LONG(a+b);return"IHDR"==d?{width:c.LONG(g),height:c.LONG(g+4)}:null}.call(this);e.extend(this,{type:"image/png",size:h.length,width:g.width,height:g.height,purge:function(){d.call(this)}});d.call(this)}});p("moxie/runtime/html5/image/ImageInfo",["moxie/core/utils/Basic",
"moxie/core/Exceptions","moxie/runtime/html5/image/JPEG","moxie/runtime/html5/image/PNG"],function(f,e,b,a){return function(d){var h=[b,a],c;c=function(){for(var a=0;a<h.length;a++)try{return new h[a](d)}catch(b){}throw new e.ImageError(e.ImageError.WRONG_FORMAT);}();f.extend(this,{type:"",size:0,width:0,height:0,setExif:function(){},writeHeaders:function(a){return a},stripHeaders:function(a){return a},purge:function(){}});f.extend(this,c);this.purge=function(){c.purge();c=null}}});p("moxie/runtime/html5/image/MegaPixel",
[],function(){function f(e){var b=e.naturalWidth;if(1048576<b*e.naturalHeight){var a=document.createElement("canvas");a.width=a.height=1;a=a.getContext("2d");a.drawImage(e,-b+1,0);return 0===a.getImageData(0,0,1,1).data[3]}return!1}return{isSubsampled:f,renderTo:function(e,b,a){var d=e.naturalWidth,h=e.naturalHeight,c=a.width,g=a.height,k=a.x||0;a=a.y||0;b=b.getContext("2d");f(e)&&(d/=2,h/=2);var r=document.createElement("canvas");r.width=r.height=1024;var l=r.getContext("2d"),n;n=h;var q=document.createElement("canvas");
q.width=1;q.height=n;q=q.getContext("2d");q.drawImage(e,0,0);for(var q=q.getImageData(0,0,1,n).data,m=0,t=n,s=n;s>m;)0===q[4*(s-1)+3]?t=s:m=s,s=t+m>>1;n=s/n;n=0===n?1:n;for(q=0;q<h;){m=q+1024>h?h-q:1024;for(t=0;t<d;){s=t+1024>d?d-t:1024;l.clearRect(0,0,1024,1024);l.drawImage(e,-t,-q);var w=t*c/d+k<<0,v=Math.ceil(s*c/d),p=q*g/h/n+a<<0,x=Math.ceil(m*g/h/n);b.drawImage(r,0,0,s,m,w,p,v,x);t+=1024}q+=1024}}}});p("moxie/runtime/html5/image/Image","moxie/runtime/html5/Runtime moxie/core/utils/Basic moxie/core/Exceptions moxie/core/utils/Encode moxie/file/File moxie/runtime/html5/image/ImageInfo moxie/runtime/html5/image/MegaPixel moxie/core/utils/Mime moxie/core/utils/Env".split(" "),
function(f,e,b,a,d,h,c,g,k){return f.Image=function(){function f(){if(!u&&!w)throw new b.ImageError(b.DOMException.INVALID_STATE_ERR);return u||w}function l(b){return a.atob(b.substring(b.indexOf("base64,")+7))}function n(c){var d=this;w=new Image;w.onerror=function(){t.call(this);d.trigger("error",b.ImageError.WRONG_FORMAT)};w.onload=function(){d.trigger("load")};w.src=/^data:[^;]*;base64,/.test(c)?c:"data:"+(A.type||"")+";base64,"+a.btoa(c)}function q(a,c){var d=this,g;if(window.FileReader)g=new FileReader,
g.onload=function(){c(this.result)},g.onerror=function(){d.trigger("error",b.ImageError.WRONG_FORMAT)},g.readAsDataURL(a);else return c(a.getAsDataURL())}function m(a,b,d,g){var h,l=0,n=0,m,q;D=g;q=this.meta&&this.meta.tiff&&this.meta.tiff.Orientation||1;-1!==e.inArray(q,[5,6,7,8])&&(m=a,a=b,b=m);m=f();d?(a=Math.min(a,m.width),b=Math.min(b,m.height),h=Math.max(a/m.width,b/m.height)):h=Math.min(a/m.width,b/m.height);if(!(1<h&&!d&&g)){u||(u=document.createElement("canvas"));g=Math.round(m.width*h);
h=Math.round(m.height*h);d?(u.width=a,u.height=b,g>a&&(l=Math.round((g-a)/2)),h>b&&(n=Math.round((h-b)/2))):(u.width=g,u.height=h);if(!D){a=u.width;b=u.height;switch(q){case 5:case 6:case 7:case 8:u.width=b;u.height=a;break;default:u.width=a,u.height=b}d=u.getContext("2d");switch(q){case 2:d.translate(a,0);d.scale(-1,1);break;case 3:d.translate(a,b);d.rotate(Math.PI);break;case 4:d.translate(0,b);d.scale(1,-1);break;case 5:d.rotate(.5*Math.PI);d.scale(1,-1);break;case 6:d.rotate(.5*Math.PI);d.translate(0,
-b);break;case 7:d.rotate(.5*Math.PI);d.translate(a,-b);d.scale(-1,1);break;case 8:d.rotate(-.5*Math.PI),d.translate(-a,0)}}q=u;l=-l;n=-n;"iOS"===k.OS?c.renderTo(m,q,{width:g,height:h,x:l,y:n}):q.getContext("2d").drawImage(m,l,n,g,h);this.width=u.width;this.height=u.height;y=!0}this.trigger("Resize")}function t(){p&&(p.purge(),p=null);x=w=u=A=null;y=!1}var s=this,w,p,u,x,A,y=!1,D=!0;e.extend(this,{loadFromBlob:function(a){var c=this,d=c.getRuntime(),g=1<arguments.length?arguments[1]:!0;if(!d.can("access_binary"))throw new b.RuntimeError(b.RuntimeError.NOT_SUPPORTED_ERR);
A=a;a.isDetached()?(x=a.getSource(),n.call(this,x)):q.call(this,a.getSource(),function(a){g&&(x=l(a));n.call(c,a)})},loadFromImage:function(a,b){this.meta=a.meta;A=new d(null,{name:a.name,size:a.size,type:a.type});n.call(this,b?x=a.getAsBinaryString():a.getAsDataURL())},getInfo:function(){var a=this.getRuntime();!p&&x&&a.can("access_image_binary")&&(p=new h(x));return{width:f().width||0,height:f().height||0,type:A.type||g.getFileMime(A.name),size:x&&x.length||A.size||0,name:A.name||"",meta:p&&p.meta||
this.meta||{}}},downsize:function(){m.apply(this,arguments)},getAsCanvas:function(){u&&(u.id=this.uid+"_canvas");return u},getAsBlob:function(a,b){a!==this.type&&m.call(this,this.width,this.height,!1);return new d(null,{name:A.name||"",type:a,data:s.getAsBinaryString.call(this,a,b)})},getAsDataURL:function(a,b){var c=b||90;if(!y)return w.src;if("image/jpeg"!==a)return u.toDataURL("image/png");try{return u.toDataURL("image/jpeg",c/100)}catch(d){return u.toDataURL("image/jpeg")}},getAsBinaryString:function(a,
b){if(!y)return x||(x=l(s.getAsDataURL(a,b))),x;if("image/jpeg"!==a)x=l(s.getAsDataURL(a,b));else{var c;b||(b=90);try{c=u.toDataURL("image/jpeg",b/100)}catch(d){c=u.toDataURL("image/jpeg")}x=l(c);p&&(x=p.stripHeaders(x),D&&(p.meta&&p.meta.exif&&p.setExif({PixelXDimension:this.width,PixelYDimension:this.height}),x=p.writeHeaders(x)),p.purge(),p=null)}y=!1;return x},destroy:function(){s=null;t.call(this);this.getRuntime().getShim().removeInstance(this.uid)}})}});p("moxie/runtime/flash/Runtime",["moxie/core/utils/Basic",
"moxie/core/utils/Env","moxie/core/utils/Dom","moxie/core/Exceptions","moxie/runtime/Runtime"],function(f,e,b,a,d){function h(){var a;try{a=navigator.plugins["Shockwave Flash"],a=a.description}catch(b){try{a=(new ActiveXObject("ShockwaveFlash.ShockwaveFlash")).GetVariable("$version")}catch(c){a="0.0"}}a=a.match(/\d+/g);return parseFloat(a[0]+"."+a[1])}var c={};d.addConstructor("flash",function(g){var k=this,r;g=f.extend({swf_url:e.swf_url},g);d.call(this,g,"flash",{access_binary:function(a){return a&&
"browser"===k.mode},access_image_binary:function(a){return a&&"browser"===k.mode},display_media:d.capTrue,do_cors:d.capTrue,drag_and_drop:!1,report_upload_progress:function(){return"client"===k.mode},resize_image:d.capTrue,return_response_headers:!1,return_response_type:function(a){return"json"===a&&window.JSON?!0:!f.arrayDiff(a,["","text","document"])||"browser"===k.mode},return_status_code:function(a){return"browser"===k.mode||!f.arrayDiff(a,[200,404])},select_file:d.capTrue,select_multiple:d.capTrue,
send_binary_string:function(a){return a&&"browser"===k.mode},send_browser_cookies:function(a){return a&&"browser"===k.mode},send_custom_headers:function(a){return a&&"browser"===k.mode},send_multipart:d.capTrue,slice_blob:function(a){return a&&"browser"===k.mode},stream_upload:function(a){return a&&"browser"===k.mode},summon_file_dialog:!1,upload_filesize:function(a){return 2097152>=f.parseSizeStr(a)||"client"===k.mode},use_http_method:function(a){return!f.arrayDiff(a,["GET","POST"])}},{access_binary:function(a){return a?
"browser":"client"},access_image_binary:function(a){return a?"browser":"client"},report_upload_progress:function(a){return a?"browser":"client"},return_response_type:function(a){return f.arrayDiff(a,["","text","json","document"])?"browser":["client","browser"]},return_status_code:function(a){return f.arrayDiff(a,[200,404])?"browser":["client","browser"]},send_binary_string:function(a){return a?"browser":"client"},send_browser_cookies:function(a){return a?"browser":"client"},send_custom_headers:function(a){return a?
"browser":"client"},stream_upload:function(a){return a?"client":"browser"},upload_filesize:function(a){return 2097152<=f.parseSizeStr(a)?"client":"browser"}},"client");10>h()&&(this.mode=!1);f.extend(this,{getShim:function(){return b.get(this.uid)},shimExec:function(a,b){var c=[].slice.call(arguments,2);return k.getShim().exec(this.uid,a,b,c)},init:function(){var b,c,d;d=this.getShimContainer();f.extend(d.style,{position:"absolute",top:"-8px",left:"-8px",width:"9px",height:"9px",overflow:"hidden"});
b='<object id="'+this.uid+'" type="application/x-shockwave-flash" data="'+g.swf_url+'" ';"IE"===e.browser&&(b+='classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" ');b+='width="100%" height="100%" style="outline:0"><param name="movie" value="'+g.swf_url+'" /><param name="flashvars" value="uid='+escape(this.uid)+"&target="+e.global_event_dispatcher+'" /><param name="wmode" value="transparent" /><param name="allowscriptaccess" value="always" /></object>';"IE"===e.browser?(c=document.createElement("div"),
d.appendChild(c),c.outerHTML=b,c=d=null):d.innerHTML=b;r=setTimeout(function(){k&&!k.initialized&&k.trigger("Error",new a.RuntimeError(a.RuntimeError.NOT_INIT_ERR))},5E3)},destroy:function(a){return function(){a.call(k);clearTimeout(r);g=r=a=k=null}}(this.destroy)},c)});return c});p("moxie/runtime/flash/file/Blob",["moxie/runtime/flash/Runtime","moxie/file/Blob"],function(f,e){return f.Blob={slice:function(b,a,d,h){var c=this.getRuntime();0>a?a=Math.max(b.size+a,0):0<a&&(a=Math.min(a,b.size));0>d?
d=Math.max(b.size+d,0):0<d&&(d=Math.min(d,b.size));(b=c.shimExec.call(this,"Blob","slice",a,d,h||""))&&(b=new e(c.uid,b));return b}}});p("moxie/runtime/flash/file/FileInput",["moxie/runtime/flash/Runtime"],function(f){return f.FileInput={init:function(e){this.getRuntime().shimExec.call(this,"FileInput","init",{name:e.name,accept:e.accept,multiple:e.multiple});this.trigger("ready")}}});p("moxie/runtime/flash/file/FileReader",["moxie/runtime/flash/Runtime","moxie/core/utils/Encode"],function(f,e){function b(a,
b){switch(b){case "readAsText":return e.atob(a,"utf8");case "readAsBinaryString":return e.atob(a);case "readAsDataURL":return a}return null}var a="";return f.FileReader={read:function(d,e){var c=this.getRuntime();"readAsDataURL"===d&&(a="data:"+(e.type||"")+";base64,");this.bind("Progress",function(c,e){e&&(a+=b(e,d))});return c.shimExec.call(this,"FileReader","readAsBase64",e.uid)},getResult:function(){return a},destroy:function(){a=null}}});p("moxie/runtime/flash/file/FileReaderSync",["moxie/runtime/flash/Runtime",
"moxie/core/utils/Encode"],function(f,e){function b(a,b){switch(b){case "readAsText":return e.atob(a,"utf8");case "readAsBinaryString":return e.atob(a);case "readAsDataURL":return a}return null}return f.FileReaderSync={read:function(a,d){var e;e=this.getRuntime().shimExec.call(this,"FileReaderSync","readAsBase64",d.uid);if(!e)return null;"readAsDataURL"===a&&(e="data:"+(d.type||"")+";base64,"+e);return b(e,a,d.type)}}});p("moxie/runtime/flash/xhr/XMLHttpRequest","moxie/runtime/flash/Runtime moxie/core/utils/Basic moxie/file/Blob moxie/file/File moxie/file/FileReaderSync moxie/xhr/FormData moxie/runtime/Transporter".split(" "),
function(f,e,b,a,d,h,c){return f.XMLHttpRequest={send:function(a,d){function f(){a.transport=m.mode;m.shimExec.call(q,"XMLHttpRequest","send",a,d)}function l(a,b){m.shimExec.call(q,"XMLHttpRequest","appendBlob",a,b.uid);d=null;f()}function n(a,b){var d=new c;d.bind("TransportingComplete",function(){b(this.result)});d.transport(a.getSource(),a.type,{ruid:m.uid})}var q=this,m=q.getRuntime();e.isEmptyObj(a.headers)||e.each(a.headers,function(a,b){m.shimExec.call(q,"XMLHttpRequest","setRequestHeader",
b,a.toString())});if(d instanceof h){var t;d.each(function(a,c){a instanceof b?t=c:m.shimExec.call(q,"XMLHttpRequest","append",c,a)});if(d.hasBlob()){var s=d.getBlob();s.isDetached()?n(s,function(a){s.destroy();l(t,a)}):l(t,s)}else d=null,f()}else d instanceof b?d.isDetached()?n(d,function(a){d.destroy();d=a.uid;f()}):(d=d.uid,f()):f()},getResponse:function(b){var c,h,f=this.getRuntime();if(h=f.shimExec.call(this,"XMLHttpRequest","getResponseAsBlob")){h=new a(f.uid,h);if("blob"===b)return h;try{c=
new d;if(~e.inArray(b,["","text"]))return c.readAsText(h);if("json"===b&&window.JSON)return JSON.parse(c.readAsText(h))}finally{h.destroy()}}return null},abort:function(a){this.getRuntime().shimExec.call(this,"XMLHttpRequest","abort");this.dispatchEvent("readystatechange");this.dispatchEvent("abort")}}});p("moxie/runtime/flash/runtime/Transporter",["moxie/runtime/flash/Runtime","moxie/file/Blob"],function(f,e){return f.Transporter={getAsBlob:function(b){var a=this.getRuntime();return(b=a.shimExec.call(this,
"Transporter","getAsBlob",b))?new e(a.uid,b):null}}});p("moxie/runtime/flash/image/Image",["moxie/runtime/flash/Runtime","moxie/core/utils/Basic","moxie/runtime/Transporter","moxie/file/Blob","moxie/file/FileReaderSync"],function(f,e,b,a,d){return f.Image={loadFromBlob:function(a){function c(a){e.shimExec.call(d,"Image","loadFromBlob",a.uid);d=e=null}var d=this,e=d.getRuntime();if(a.isDetached()){var f=new b;f.bind("TransportingComplete",function(){c(f.result.getSource())});f.transport(a.getSource(),
a.type,{ruid:e.uid})}else c(a.getSource())},loadFromImage:function(a){return this.getRuntime().shimExec.call(this,"Image","loadFromImage",a.uid)},getAsBlob:function(b,c){var d=this.getRuntime(),e=d.shimExec.call(this,"Image","getAsBlob",b,c);return e?new a(d.uid,e):null},getAsDataURL:function(){var a=this.getRuntime().Image.getAsBlob.apply(this,arguments);return a?(new d).readAsDataURL(a):null}}});p("moxie/runtime/silverlight/Runtime",["moxie/core/utils/Basic","moxie/core/utils/Env","moxie/core/utils/Dom",
"moxie/core/Exceptions","moxie/runtime/Runtime"],function(f,e,b,a,d){function h(a){var b=!1,c=null,d,e,f,h,t,s=0;try{try{c=new ActiveXObject("AgControl.AgControl"),c.IsVersionSupported(a)&&(b=!0)}catch(p){var v=navigator.plugins["Silverlight Plug-In"];if(v){d=v.description;"1.0.30226.2"===d&&(d="2.0.30226.2");for(e=d.split(".");3<e.length;)e.pop();for(;4>e.length;)e.push(0);for(f=a.split(".");4<f.length;)f.pop();do h=parseInt(f[s],10),t=parseInt(e[s],10),s++;while(s<f.length&&h===t);h<=t&&!isNaN(h)&&
(b=!0)}}}catch(u){b=!1}return b}var c={};d.addConstructor("silverlight",function(g){var k=this,r;g=f.extend({xap_url:e.xap_url},g);d.call(this,g,"silverlight",{access_binary:d.capTrue,access_image_binary:d.capTrue,display_media:d.capTrue,do_cors:d.capTrue,drag_and_drop:!1,report_upload_progress:d.capTrue,resize_image:d.capTrue,return_response_headers:function(a){return a&&"client"===k.mode},return_response_type:function(a){return"json"!==a?!0:!!window.JSON},return_status_code:function(a){return"client"===
k.mode||!f.arrayDiff(a,[200,404])},select_file:d.capTrue,select_multiple:d.capTrue,send_binary_string:d.capTrue,send_browser_cookies:function(a){return a&&"browser"===k.mode},send_custom_headers:function(a){return a&&"client"===k.mode},send_multipart:d.capTrue,slice_blob:d.capTrue,stream_upload:!0,summon_file_dialog:!1,upload_filesize:d.capTrue,use_http_method:function(a){return"client"===k.mode||!f.arrayDiff(a,["GET","POST"])}},{return_response_headers:function(a){return a?"client":"browser"},return_status_code:function(a){return f.arrayDiff(a,
[200,404])?"client":["client","browser"]},send_browser_cookies:function(a){return a?"browser":"client"},send_custom_headers:function(a){return a?"client":"browser"},use_http_method:function(a){return f.arrayDiff(a,["GET","POST"])?"client":["client","browser"]}});h("2.0.31005.0")&&"Opera"!==e.browser||(this.mode=!1);f.extend(this,{getShim:function(){return b.get(this.uid).content.Moxie},shimExec:function(a,b){var c=[].slice.call(arguments,2);return k.getShim().exec(this.uid,a,b,c)},init:function(){this.getShimContainer().innerHTML=
'<object id="'+this.uid+'" data="data:application/x-silverlight," type="application/x-silverlight-2" width="100%" height="100%" style="outline:none;"><param name="source" value="'+g.xap_url+'"/><param name="background" value="Transparent"/><param name="windowless" value="true"/><param name="enablehtmlaccess" value="true"/><param name="initParams" value="uid='+this.uid+",target="+e.global_event_dispatcher+'"/></object>';r=setTimeout(function(){k&&!k.initialized&&k.trigger("Error",new a.RuntimeError(a.RuntimeError.NOT_INIT_ERR))},
"Windows"!==e.OS?1E4:5E3)},destroy:function(a){return function(){a.call(k);clearTimeout(r);g=r=a=k=null}}(this.destroy)},c)});return c});p("moxie/runtime/silverlight/file/Blob",["moxie/runtime/silverlight/Runtime","moxie/core/utils/Basic","moxie/runtime/flash/file/Blob"],function(f,e,b){return f.Blob=e.extend({},b)});p("moxie/runtime/silverlight/file/FileInput",["moxie/runtime/silverlight/Runtime"],function(f){return f.FileInput={init:function(e){this.getRuntime().shimExec.call(this,"FileInput","init",
function(b){for(var a="",d=0;d<b.length;d++)a+=(""!==a?"|":"")+b[d].title+" | *."+b[d].extensions.replace(/,/g,";*.");return a}(e.accept),e.name,e.multiple);this.trigger("ready")}}});p("moxie/runtime/silverlight/file/FileDrop",["moxie/runtime/silverlight/Runtime","moxie/core/utils/Dom","moxie/core/utils/Events"],function(f,e,b){return f.FileDrop={init:function(){var a=this.getRuntime(),d;d=a.getShimContainer();b.addEvent(d,"dragover",function(a){a.preventDefault();a.stopPropagation();a.dataTransfer.dropEffect=
"copy"},this.uid);b.addEvent(d,"dragenter",function(b){b.preventDefault();e.get(a.uid).dragEnter(b)&&b.stopPropagation()},this.uid);b.addEvent(d,"drop",function(b){b.preventDefault();e.get(a.uid).dragDrop(b)&&b.stopPropagation()},this.uid);return a.shimExec.call(this,"FileDrop","init")}}});p("moxie/runtime/silverlight/file/FileReader",["moxie/runtime/silverlight/Runtime","moxie/core/utils/Basic","moxie/runtime/flash/file/FileReader"],function(f,e,b){return f.FileReader=e.extend({},b)});p("moxie/runtime/silverlight/file/FileReaderSync",
["moxie/runtime/silverlight/Runtime","moxie/core/utils/Basic","moxie/runtime/flash/file/FileReaderSync"],function(f,e,b){return f.FileReaderSync=e.extend({},b)});p("moxie/runtime/silverlight/xhr/XMLHttpRequest",["moxie/runtime/silverlight/Runtime","moxie/core/utils/Basic","moxie/runtime/flash/xhr/XMLHttpRequest"],function(f,e,b){return f.XMLHttpRequest=e.extend({},b)});p("moxie/runtime/silverlight/runtime/Transporter",["moxie/runtime/silverlight/Runtime","moxie/core/utils/Basic","moxie/runtime/flash/runtime/Transporter"],
function(f,e,b){return f.Transporter=e.extend({},b)});p("moxie/runtime/silverlight/image/Image",["moxie/runtime/silverlight/Runtime","moxie/core/utils/Basic","moxie/runtime/flash/image/Image"],function(f,e,b){return f.Image=e.extend({},b,{getInfo:function(){var a=["tiff","exif","gps"],b={meta:{}},f=this.getRuntime().shimExec.call(this,"Image","getInfo");f.meta&&e.each(a,function(a){var e=f.meta[a],k,r,l,n;if(e&&e.keys)for(b.meta[a]={},r=0,l=e.keys.length;r<l;r++)if(k=e.keys[r],n=e[k])/^(\d|[1-9]\d+)$/.test(n)?
n=parseInt(n,10):/^\d*\.\d+$/.test(n)&&(n=parseFloat(n)),b.meta[a][k]=n});b.width=parseInt(f.width,10);b.height=parseInt(f.height,10);b.size=parseInt(f.size,10);b.type=f.type;b.name=f.name;return b}})});p("moxie/runtime/html4/Runtime",["moxie/core/utils/Basic","moxie/core/Exceptions","moxie/runtime/Runtime","moxie/core/utils/Env"],function(f,e,b,a){var d={};b.addConstructor("html4",function(e){var c=this,g=b.capTest,k=b.capTrue;b.call(this,e,"html4",{access_binary:g(window.FileReader||window.File&&
File.getAsDataURL),access_image_binary:!1,display_media:g(d.Image&&(a.can("create_canvas")||a.can("use_data_uri_over32kb"))),do_cors:!1,drag_and_drop:!1,filter_by_extension:g("Chrome"===a.browser&&28<=a.version||"IE"===a.browser&&10<=a.version),resize_image:function(){return d.Image&&c.can("access_binary")&&a.can("create_canvas")},report_upload_progress:!1,return_response_headers:!1,return_response_type:function(a){return"json"===a&&window.JSON?!0:!!~f.inArray(a,["text","document",""])},return_status_code:function(a){return!f.arrayDiff(a,
[200,404])},select_file:function(){return a.can("use_fileinput")},select_multiple:!1,send_binary_string:!1,send_custom_headers:!1,send_multipart:!0,slice_blob:!1,stream_upload:function(){return c.can("select_file")},summon_file_dialog:g("Firefox"===a.browser&&4<=a.version||"Opera"===a.browser&&12<=a.version||!!~f.inArray(a.browser,["Chrome","Safari"])),upload_filesize:k,use_http_method:function(a){return!f.arrayDiff(a,["GET","POST"])}});f.extend(this,{init:function(){this.trigger("Init")},destroy:function(a){return function(){a.call(c);
a=c=null}}(this.destroy)});f.extend(this.getShim(),d)});return d});p("moxie/runtime/html4/file/FileInput","moxie/runtime/html4/Runtime moxie/core/utils/Basic moxie/core/utils/Dom moxie/core/utils/Events moxie/core/utils/Mime moxie/core/utils/Env".split(" "),function(f,e,b,a,d,h){return f.FileInput=function(){function c(){var d=this,q=d.getRuntime(),m,t,s,p,v;v=e.guid("uid_");m=q.getShimContainer();f&&(t=b.get(f+"_form"))&&e.extend(t.style,{top:"100%"});s=document.createElement("form");s.setAttribute("id",
v+"_form");s.setAttribute("method","post");s.setAttribute("enctype","multipart/form-data");s.setAttribute("encoding","multipart/form-data");e.extend(s.style,{overflow:"hidden",position:"absolute",top:0,left:0,width:"100%",height:"100%"});p=document.createElement("input");p.setAttribute("id",v);p.setAttribute("type","file");p.setAttribute("name",l.name||"Filedata");p.setAttribute("accept",r.join(","));e.extend(p.style,{fontSize:"999px",opacity:0});s.appendChild(p);m.appendChild(s);e.extend(p.style,
{position:"absolute",top:0,left:0,width:"100%",height:"100%"});"IE"===h.browser&&10>h.version&&e.extend(p.style,{filter:"progid:DXImageTransform.Microsoft.Alpha(opacity=0)"});p.onchange=function(){var a;this.value&&(a=this.files?this.files[0]:{name:this.value},k=[a],this.onchange=function(){},c.call(d),d.bind("change",function A(){var a=b.get(v),c=b.get(v+"_form"),e;d.unbind("change",A);d.files.length&&a&&c&&(e=d.files[0],a.setAttribute("id",e.uid),c.setAttribute("id",e.uid+"_form"),c.setAttribute("target",
e.uid+"_iframe"))},998),p=s=null,d.trigger("change"))};q.can("summon_file_dialog")&&(q=b.get(l.browse_button),a.removeEvent(q,"click",d.uid),a.addEvent(q,"click",function(a){p&&!p.disabled&&p.click();a.preventDefault()},d.uid));f=v;m=t=q=null}var f,k=[],r=[],l;e.extend(this,{init:function(e){var f=this,g=f.getRuntime(),h;l=e;r=e.accept.mimes||d.extList2mimes(e.accept,g.can("filter_by_extension"));h=g.getShimContainer();(function(){var c,d;c=b.get(e.browse_button);g.can("summon_file_dialog")&&("static"===
b.getStyle(c,"position")&&(c.style.position="relative"),d=parseInt(b.getStyle(c,"z-index"),10)||1,c.style.zIndex=d,h.style.zIndex=d-1);c=g.can("summon_file_dialog")?c:h;a.addEvent(c,"mouseover",function(){f.trigger("mouseenter")},f.uid);a.addEvent(c,"mouseout",function(){f.trigger("mouseleave")},f.uid);a.addEvent(c,"mousedown",function(){f.trigger("mousedown")},f.uid);a.addEvent(b.get(e.container),"mouseup",function(){f.trigger("mouseup")},f.uid);c=null})();c.call(this);h=null;f.trigger({type:"ready",
async:!0})},getFiles:function(){return k},disable:function(a){var c;if(c=b.get(f))c.disabled=!!a},destroy:function(){var c=this.getRuntime(),d=c.getShim(),c=c.getShimContainer();a.removeAllEvents(c,this.uid);a.removeAllEvents(l&&b.get(l.container),this.uid);a.removeAllEvents(l&&b.get(l.browse_button),this.uid);c&&(c.innerHTML="");d.removeInstance(this.uid);f=k=r=l=null}})}});p("moxie/runtime/html4/file/FileReader",["moxie/runtime/html4/Runtime","moxie/runtime/html5/file/FileReader"],function(f,e){return f.FileReader=
e});p("moxie/runtime/html4/xhr/XMLHttpRequest","moxie/runtime/html4/Runtime moxie/core/utils/Basic moxie/core/utils/Dom moxie/core/utils/Url moxie/core/Exceptions moxie/core/utils/Events moxie/file/Blob moxie/xhr/FormData".split(" "),function(f,e,b,a,d,h,c,g){return f.XMLHttpRequest=function(){function f(a){var c=this,d,e,g,k=!1;if(n){d=n.id.replace(/_iframe$/,"");if(d=b.get(d+"_form")){e=d.getElementsByTagName("input");for(g=e.length;g--;)switch(e[g].getAttribute("type")){case "hidden":e[g].parentNode.removeChild(e[g]);
break;case "file":k=!0}e=[];k||d.parentNode.removeChild(d);d=null}setTimeout(function(){h.removeEvent(n,"load",c.uid);n.parentNode&&n.parentNode.removeChild(n);var b=c.getRuntime().getShimContainer();b.children.length||b.parentNode.removeChild(b);n=null;a()},1)}}var p,l,n;e.extend(this,{send:function(q,m){var t=this,s=t.getRuntime(),w,v,u,x;p=l=null;if(m instanceof g&&m.hasBlob()){if(x=m.getBlob(),w=x.uid,u=b.get(w),v=b.get(w+"_form"),!v)throw new d.DOMException(d.DOMException.NOT_FOUND_ERR);}else w=
e.guid("uid_"),v=document.createElement("form"),v.setAttribute("id",w+"_form"),v.setAttribute("method",q.method),v.setAttribute("enctype","multipart/form-data"),v.setAttribute("encoding","multipart/form-data"),v.setAttribute("target",w+"_iframe"),s.getShimContainer().appendChild(v);m instanceof g&&m.each(function(a,b){if(a instanceof c)u&&u.setAttribute("name",b);else{var d=document.createElement("input");e.extend(d,{type:"hidden",name:b,value:a});u?v.insertBefore(d,u):v.appendChild(d)}});v.setAttribute("action",
q.url);(function(){var b=s.getShimContainer()||document.body,c=document.createElement("div");c.innerHTML='<iframe id="'+w+'_iframe" name="'+w+'_iframe" src="javascript:&quot;&quot;" style="display:none"></iframe>';n=c.firstChild;b.appendChild(n);h.addEvent(n,"load",function(){var b;try{b=n.contentWindow.document||n.contentDocument||window.frames[n.id].document,/^4(0[0-9]|1[0-7]|2[2346])\s/.test(b.title)?p=b.title.replace(/^(\d+).*$/,"$1"):(p=200,l=e.trim(b.body.innerHTML),t.trigger({type:"progress",
loaded:l.length,total:l.length}),x&&t.trigger({type:"uploadprogress",loaded:x.size||1025,total:x.size||1025}))}catch(c){if(a.hasSameOrigin(q.url))p=404;else{f.call(t,function(){t.trigger("error")});return}}f.call(t,function(){t.trigger("load")})},t.uid)})();v.submit();t.trigger("loadstart")},getStatus:function(){return p},getResponse:function(a){if("json"===a&&"string"===e.typeOf(l)&&window.JSON)try{return JSON.parse(l.replace(/^\s*<pre[^>]*>/,"").replace(/<\/pre>\s*$/,""))}catch(b){return null}return l},
abort:function(){var a=this;n&&n.contentWindow&&(n.contentWindow.stop?n.contentWindow.stop():n.contentWindow.document.execCommand?n.contentWindow.document.execCommand("Stop"):n.src="about:blank");f.call(this,function(){a.dispatchEvent("abort")})}})}});p("moxie/runtime/html4/image/Image",["moxie/runtime/html4/Runtime","moxie/runtime/html5/image/Image"],function(f,e){return f.Image=e});(function(f){for(var e=0;e<f.length;e++){for(var b=B,a=f[e],d=a.split(/[.\/]/),h=0;h<d.length-1;++h)b[d[h]]===y&&(b[d[h]]=
{}),b=b[d[h]];b[d[d.length-1]]=G[a]}})("moxie/core/utils/Basic moxie/core/I18n moxie/core/utils/Mime moxie/core/utils/Env moxie/core/utils/Dom moxie/core/Exceptions moxie/core/EventTarget moxie/core/utils/Encode moxie/runtime/Runtime moxie/runtime/RuntimeClient moxie/file/Blob moxie/file/File moxie/file/FileInput moxie/file/FileDrop moxie/runtime/RuntimeTarget moxie/file/FileReader moxie/core/utils/Url moxie/file/FileReaderSync moxie/xhr/FormData moxie/xhr/XMLHttpRequest moxie/runtime/Transporter moxie/image/Image moxie/core/utils/Events".split(" "))})(this);
(function(B){var y={},N=B.moxie.core.utils.Basic.inArray;(function G(f){var e,b;for(e in f)b=typeof f[e],"object"!==b||~N(e,["Exceptions","Env","Mime"])?"function"===b&&(y[e]=f[e]):G(f[e])})(B.moxie);y.Env=B.moxie.core.utils.Env;y.Mime=B.moxie.core.utils.Mime;y.Exceptions=B.moxie.core.Exceptions;B.mOxie=y;B.o||(B.o=y);return y})(this);
